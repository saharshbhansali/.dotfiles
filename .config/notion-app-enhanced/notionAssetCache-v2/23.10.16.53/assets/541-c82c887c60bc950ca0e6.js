"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[541],{7512:(e,t,s)=>{s.d(t,{A:()=>g,t:()=>h});var i=s(9953),o=s(58762),r=s(92625),n=s(47307),a=s(97977),d=s(27832),l=s(50906),p=s(39218),u=s(5366),m=s(33929);const c=(0,u.defineMessages)({deletingAccount:{id:"accountActions.deletingAccount.loadingMessage",defaultMessage:"Deleting your account…"},noUserError:{id:"accountActions.deletingAccount.noUserToDeleteMessage",defaultMessage:"No account to delete."}}),g=function(e){const{userStore:t,data:s,transaction:o}=e,r={};s.name&&(r.name=s.name),r.profile_photo=s.profilePhoto,i.sW({store:t,data:r,transaction:o})};async function h(e){r.j({message:c.deletingAccount});const t=e.currentUser.id,{currentUserRootStore:s,currentUserStore:i}=d.default.state;if(!s||!i||!t)return r.x(),void n.showErrorMessage(m.default.formatMessage(c.noUserError));l.xti(e),await o.deleteUser(e,{}),await p.transactionQueue.clearForUser(t),a.logoutSingleAccount({environment:e,userId:t}),r.x()}},86080:(e,t,s)=>{s.d(t,{b:()=>r,x:()=>n});var i=s(29477),o=s(81700);const r=function(e){const t=i.UZ();return o.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},n=function(e){const t=o.Z.state;t.open&&(t.onComplete(e.didConfirm),o.Z.reset())}},97832:(e,t,s)=>{s.d(t,{Z:()=>k});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(33948),s(96486)),d=s.n(a),l=s(5366),p=(s(67294),s(90965)),u=s(38755),m=s(27832),c=s(66832),g=s(47966),h=s(23189),v=s(7512),f=s(50906),S=s(86080),y=s(92083),b=s(93007),M=s(8848),w=s(82990);class P extends c.Z{constructor(...e){super(...e),n()(this,"handleDeleteAccountClick",(async()=>{const{currentUserStore:e,currentUserRootStore:t}=m.default.state;if(!e||!t)return;const s=e.getValue();if(!s)return;const i=d().compact(t.getSpaceViewStores().map((e=>e.getSpaceStore()))).filter((e=>!(0,p.XO)(s.id,e.getValue(),e.getRole()))),r=d().compact(i.map((e=>(0,u.getSpaceName)(this.environment,e))));f.qPY(this.environment);await S.b({width:420,message:o()("div",{},void 0,o()("div",{},void 0,o()(l.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.warning",defaultMessage:"This action cannot be undone. This will permanently delete your entire account. All private workspaces will be deleted, and you will be removed from all shared workspaces."}),r.length>0&&o()("ul",{style:{padding:0}},void 0,r.map((e=>o()("li",{style:{marginTop:6,color:M.ZP.red,fontWeight:w.Z.fontWeight.medium,listStyle:"none"}},void 0,e))))," ",o()(l.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.prompt",defaultMessage:"Please type in your email to confirm."})),o()(b.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente su cuenta completa. Se eliminarán todas las áreas de trabajo privadas y se eliminará de todas las áreas de trabajo compartidas. Por favor, escriba su correo electrónico para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит всю вашу учетную запись. Все частные рабочие области будут удалены, и вы будете удалены из всех общих рабочих областей. Пожалуйста, введите ваш адрес электронной почты для подтверждения.",zh:"此操作无法撤消。 这将永久删除您的整个帐户。 将删除所有私有工作空间，您将从所有共享工作空间中删除。 请输入您的电子邮箱进行确认。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird Ihr gesamtes Konto dauerhaft gelöscht. Alle privaten Arbeitsbereiche werden gelöscht und Sie werden aus allen freigegebenen Arbeitsbereichen entfernt. Bitte geben Sie Ihre E-Mail-Adresse zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement votre compte en entier. Tous les espaces de travail privés seront supprimés et vous serez supprimé de tous les espaces de travail partagés. Veuillez taper votre email pour confirmer.",ja:"この操作を元に戻すことはできません。 これによりアカウント全体が完全に削除されます。 すべてのプライベートワークスペースが削除され、あなたはすべての共有ワークスペースから削除されます。 確認のためにメールアドレスを入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'intero account. Tutti gli spazi di lavoro privati verranno eliminati e verranno rimossi da tutti gli spazi di lavoro condivisi. Inserisci la tua email per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente sua conta inteira. Todos os espaços de trabalho privados serão excluídos e você será removido de todos os espaços de trabalho compartilhados. Por favor, digite o seu email para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt uw gehele account permanent verwijderd. Alle privéwerkruimten worden verwijderd en u wordt verwijderd uit alle gedeelde werkruimten. Voer je e-mailadres in om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie całego konta. Wszystkie prywatne obszary robocze zostaną usunięte, a użytkownik zostanie usunięty ze wszystkich współużytkowanych obszarów roboczych. Wpisz swój e-mail, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort hela ditt konto permanent. Alla privata arbetsytor kommer att raderas, och du kommer att tas bort från alla delade arbetsytor. Vänligen skriv in din email för att bekräfta.",uk:"Цю дію не можна скасувати. Таким чином буде видалено весь обліковий запис назавжди. Всі приватні робочі області будуть видалені, і ви будете видалені з усіх спільних робочих областей. Будь ласка, введіть електронний лист для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette hele kontoen din. Alle private arbeidsområder blir slettet, og du vil bli fjernet fra alle delte arbeidsområder. Vennligst skriv inn din epost for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu işlem hesabınızın tamamını kalıcı olarak siler. Tüm özel çalışma alanları silinecek ve paylaşılan tüm çalışma alanlarından kaldırılacaksınız. Lütfen onaylamak için e-postanızı yazın.",cs:"Tuto akci nelze vrátit zpět. Tím bude trvale smazán celý váš účet. Všechny soukromé pracovní prostory budou smazány a budete ze všech sdílených pracovních prostor odstraněni. Pro potvrzení zadejte svůj e-mail.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn toàn bộ tài khoản của bạn. Tất cả các không gian làm việc riêng tư sẽ bị xóa và bạn sẽ bị xóa khỏi tất cả các không gian làm việc chung. Vui lòng nhập email của bạn để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette hele din konto. Alle private arbejdsområder slettes, og du vil blive fjernet fra alle delte arbejdsområder. Indtast venligst din email for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a teljes fiókot. Minden privát munkaterület törlődik, és eltávolításra kerül minden megosztott munkaterületről. Kérjük, írja be e-mail címét, hogy megerősítse.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي الإجراء إلى حذف حسابك بالكامل. سيتم أيضا حذف جميع مساحات العمل الخاصة ، وستتم إزالتك من جميع مساحات العمل المشتركة. يرجى كتابة البريد الإلكتروني الخاص بك للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบบัญชีทั้งหมดของคุณอย่างถาวร พื้นที่ทำงานส่วนตัวทั้งหมดจะถูกลบและคุณจะถูกลบออกจากพื้นที่ทำงานที่ใช้ร่วมกันทั้งหมด กรุณาพิมพ์อีเมลของคุณเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את כל החשבון שלך. כל סביבות העבודה הפרטיות יימחקו, ותוסר מכל סביבות העבודה המשותפות. הקלד את האימייל שלך כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa koko tilin pysyvästi. Kaikki yksityiset työtilat poistetaan ja poistetaan kaikista jaetuista työtiloista. Vahvistaaksesi kirjoita sähköpostiosoitteesi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus seluruh akun Anda. Semua ruang kerja pribadi akan dihapus, dan Anda akan dihapus dari semua ruang kerja bersama. Ketikkan email Anda untuk mengonfirmasi."}})),acceptLabel:0===r.length?o()(l.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.deleteAccountButton.label",defaultMessage:"Permanently delete account"}):o()(l.FormattedMessage,{id:"profileSettings.deleteAccountConfirmationDialog.deleteAccountAndWorkspacesButton.label",defaultMessage:"{numberOfWorkspaces, plural, one {Permanently delete account and 1 workspace} other {Permanently delete account and {numberOfWorkspaces} workspaces}}",values:{numberOfWorkspaces:r.length}}),requiredInputValue:s.email})&&(f.psf(this.environment),y.ZP.reset(),v.t(this.environment))}))}renderComponent(){return[o()(h.Z,{},void 0,o()(l.FormattedMessage,{id:"profileSettings.dangerousSettings.title",defaultMessage:"Danger zone",description:"Title for the user settings that we consider 'dangerous', like deleting an account."})),o()(g.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteAccountClick},void 0,o()(l.FormattedMessage,{id:"profileSettings.dangerousSettings.deleteAccountButton.label",defaultMessage:"Delete my account"}))]}}const k=P},79092:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(33948),s(67294),s(5366)),d=s(66832),l=s(27832),p=s(37181),u=s(55422);class m extends d.Z{constructor(...e){super(...e),n()(this,"handleStartOfWeekToggle",(()=>{1===this.getStartDayOfWeek()?p.rx(this.environment):p.Zf(this.environment)}))}renderComponent(){const{device:e}=this.environment;return o()(u.Z,{isMobile:e.isMobile,title:o()(a.FormattedMessage,{id:"calendarSettings.startWeekOnMonday.label",defaultMessage:"Start week on Monday"}),caption:o()(a.FormattedMessage,{id:"calendarSettings.startWeekOnMonday.message",defaultMessage:"This will change how all calendars in your app look."}),type:"toggle",isOn:1===this.getStartDayOfWeek(),onToggle:this.handleStartOfWeekToggle})}getStartDayOfWeek(){const{currentUserSettingsStore:e}=l.default.state;if(e){const t=e.getSettings();if(t)return t.start_day_of_week}}}const c=m},21752:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(98135),o=s.n(i),r=(s(67294),s(5366)),n=s(19889),a=s(84882),d=s(46951);const l=function(e){const t=(0,r.useIntl)(),{userValue:s,containerStyle:i}=e;return s?o()("div",{style:{display:"flex",alignItems:"center",maxWidth:300,...i}},void 0,o()(a.Z,{userValue:s,size:28}),o()("div",{style:{minWidth:0,marginLeft:6,marginRight:6}},void 0,o()(d.Z,{className:"notranslate"},void 0,(0,n.Nz)(t,s)),o()(d.Z,{isSmall:!0},void 0,s.email))):null}},79603:(e,t,s)=>{s.d(t,{mS:()=>L,Ub:()=>A,Pp:()=>G});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=(s(33948),s(67294)),d=s.n(a),l=s(89940),p=s(95155),u=s(25584),m=s(83071),c=s(46167),g=s(58879),h=s(3779),v=s(64215),f=s(71202),S=s(5366),y=s(48762),b=s(40235),M=s(23189),w=s(46951),P=s(62727),k=s(47966),Z=s(27386),C=s(69972),T=s(68932),I=s(96486),x=s.n(I),F=s(95477);const B="janus";function L(){return"production"!==F.default.env&&("on"===p.default.getGroup(B)||"local"===F.default.env)}function A(e){const t=(0,g.O7)(),[s,i]=(0,a.useState)(""),[r,Z]=(0,a.useState)(void 0),C=(0,l.VK)((()=>p.default.getExperiments().filter((e=>e.experimentId!==B&&(!s||0===s.length||e.experimentId.includes(s)))).sort(((e,t)=>e.experimentId>t.experimentId?1:-1))),[s]),{device:I}=t,F=I.isMobile,L=(0,v.y)((e=>({containerStyle:{width:"100%"},headerContainerStyle:{display:"flex",alignItems:"flex-start",cursor:"pointer",width:"100%",flexWrap:"wrap"},headerLabelStyle:{marginTop:2,marginBottom:12,padding:2,flex:1},filterContainerStyle:{paddingBottom:"12px"},resetButtonContainerStyle:{paddingBottom:"12px"},tableExperimentIDHeaderStyle:{width:"auto"},tableExperimentGroupHeaderStyle:{width:"auto",textAlign:"right"},experimentGroupContainerStyle:{width:"100%",display:"flex",justifyContent:"flex-end"},experimentGroupButtonStyle:{maxWidth:F?"100px":void 0,overflowX:"hidden",justifyContent:"left"},experimentGroupButtonChevronStyle:{width:10,marginLeft:4,fill:e.lightIconColor},experimentGroupButtonCheckContainerStyle:{width:F?16:14}})),[F]);return n()("div",{style:L.containerStyle},void 0,n()(M.Z,{large:!I.isMobile||void 0},void 0,"Experiment Overrides"),n()("div",{style:L.headerContainerStyle},void 0,n()(w.Z,{isSmall:!0,isMultiline:!0,style:L.headerLabelStyle},void 0,"Turn on (or off) experiments for yourself. This only works for experiments that are based on userId or deviceId"),n()("div",{style:L.resetButtonContainerStyle},void 0,n()(k.Z,{isSmall:!0,onClick:()=>{Z({reset:!0}),p.default.resetExperimentOverrides(t).then((()=>{Z(void 0)}))}},void 0,null!=r&&r.reset?n()(T.Z,{}):"Reset to defaults"))),n()("div",{style:L.filterContainerStyle},void 0,n()(P.Z,{placeholder:"Filter by Experiment ID...",value:s,showClearButton:!0,autoCapitalize:"off",autoComplete:"off",onChange:e=>{i(e.target.value)}})),n()(b.Z,{columns:[{key:"name",header:"Experiment ID",style:L.tableExperimentIDHeaderStyle},{key:"group",header:"Group",style:L.tableExperimentGroupHeaderStyle}],rows:C.map((e=>{const s=e.group;return{key:e.experimentId,columns:[e.experimentId,n()("div",{style:L.experimentGroupContainerStyle},void 0,n()(c.Z,{popupType:I.isMobile?c.Z.PopupType.SlideUp:c.Z.PopupType.Popup,renderOrigin:t=>d().createElement(k.Z,o()({},t,{key:e.experimentId,style:L.experimentGroupButtonStyle}),null!=s?s:"unknown",h.Z.chevronDown(L.experimentGroupButtonChevronStyle)),render:i=>{let a;a=I.isMobile?{menuType:f.ZP.MenuType.Modal,title:e.experimentId,right:n()(S.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:i.close}:{menuType:f.ZP.MenuType.Popup,width:250};const l=e.groups.map((a=>({key:a,action:s=>{Z({experimentId:e.experimentId,group:a}),p.default.setExperimentOverride(t,e.experimentId,a).then((()=>{Z(void 0),x().delay((()=>{i.close()}),1e3)}))},render:(t,i)=>d().createElement(y.Z,o()({},t,{title:a,right:r&&r.experimentId===e.experimentId&&r.group===a?n()("div",{style:L.experimentGroupButtonCheckContainerStyle},void 0,n()(T.Z,{})):a!==s||r?void 0:n()("div",{style:L.experimentGroupButtonCheckContainerStyle},void 0,h.Z.check())}))})));return d().createElement(f.ZP,a,n()(u.Z,{type:u.Z.Type.Vertical,initialFocus:void 0,sections:[{key:e.experimentId,render:e=>d().createElement(m.Z,e),items:l}]}))}}))]}}))}))}function G(e){const t=(0,v.y)((e=>({headerLabelStyle:{marginTop:2,width:"80%"},outlineButtonStyle:{marginTop:12,marginBottom:4}})),[]);return n()("div",{},void 0,n()(M.Z,{},void 0,"Experiments"),n()(w.Z,{isSmall:!0,isMultiline:!0,style:t.headerLabelStyle},void 0,"Locally turn on (or off) experiments"),n()(c.Z,{popupType:c.Z.PopupType.SlideUp,renderOrigin:e=>d().createElement(k.Z,o()({},e,{isLarge:!0,style:t.outlineButtonStyle}),"View Experiments"),render:e=>{const t={menuType:f.ZP.MenuType.Modal,whiteBackground:!0,title:"Experiments",right:n()(S.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:e.close};return n()(C.Z,{capture:!0,allowEsc:!0,render:()=>d().createElement(f.ZP,t,n()(Z.Z,{disableScroller:!0},void 0,n()(A,{})))})}}))}},64131:(e,t,s)=>{s.d(t,{Z:()=>U});var i=s(98135),o=s.n(i),r=s(67154),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(67294)),p=s.n(l),u=s(46167),m=s(66832),c=s(37235),g=s(98742),h=s(50906),v=s(14947),f=s(24666),S=s(3779),y=s(25584),b=s(71202),M=s(83071),w=s(98724),P=s(8848),k=s(41216),Z=s(82990),C=s(52689),T=s(52377),I=s(63334),x=s(70203),F=s(94610),B=s(89086),L=s(5366),A=s(15282),G=s(4708);const R=p().Fragment;class E extends m.Z{constructor(...e){super(...e),d()(this,"storeTypes",{ignoreSelectionAreaStore:I.Z}),d()(this,"renderHighlightColorMenuItem",((e,t,s,i)=>({key:t||e,action:()=>{s(),this.menuItemAction(e),i.close()},render:s=>p().createElement(k.Z,n()({},s,{color:e,overrideDisplayName:t}))}))),d()(this,"handleToggleHighlightAnnotation",(()=>{w.aS({environment:this.environment,annotation:["h",C.Z.state.color]}),h.mt_(this.environment,{action:"h",color:C.Z.state.color})})),d()(this,"handleButtonPopupClick",(e=>{h.mt_(this.environment,{action:"h"})})),d()(this,"handleClose",(()=>{f.default.emit()})),d()(this,"menuItemAction",(e=>{w.mX({environment:this.environment,annotationType:"h"}),"default"!==e&&(C.Z.setHighlightColor(e),this.handleToggleHighlightAnnotation())}))}renderComponent(){const{device:e}=this.environment,{intl:t}=this.props;return o()(u.Z,{popupType:e.isMobile?u.Z.PopupType.SlideUp:u.Z.PopupType.Popup,originGap:4,onClose:this.handleClose,onClick:this.handleButtonPopupClick,renderOrigin:t=>o()(c.Z,{renderTooltip:()=>o()(R,{},void 0,o()("div",{},void 0,o()(L.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})),o()("div",{},void 0,o()(F.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleHighlight"}))),render:s=>p().createElement(v.Z,n()({style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",...this.props.style},disabled:this.props.disabled,disabledFeedback:this.props.disabled},(0,g.Z)(t,s)),o()("div",{style:this.getColorIconStyle()},void 0,e.isMobile?o()(L.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"}):"A"),S.Z.chevronDown({width:10,marginLeft:e.isMobile?4:3,fill:"dark"===this.theme.mode?P.ZP.white:this.theme.lightIconColor}))}),render:s=>{let i;return i=e.isMobile?{menuType:b.ZP.MenuType.Modal,title:o()(L.FormattedMessage,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:o()(A.CancelMenuText,{}),onClickRight:()=>{s.close()}}:{menuType:b.ZP.MenuType.Popup},p().createElement(b.ZP,i,o()(T.Z,{capture:e.isMobile,store:this.stores.ignoreSelectionAreaStore,ignoreBlockSelection:!1,restoreSelection:!0,focusOffscreenInput:!1,render:e=>{const i=P.CY.map((t=>this.renderHighlightColorMenuItem(t,void 0,e,s))),r=[this.renderHighlightColorMenuItem("default",t.formatMessage({defaultMessage:"Default background",id:"highlightSelectionButton.defaultBackground.label"}),e,s),...P._K.map((t=>this.renderHighlightColorMenuItem(t,void 0,e,s)))],a=C.Z.state.color;return o()(y.Z,{type:y.Z.Type.Vertical,sections:[{key:0,items:[{key:0,action:()=>{e(),this.menuItemAction(a),s.close()},render:e=>p().createElement(k.Z,n()({},e,{color:a,shortcuts:["toggleHighlight"]}))}],render:e=>p().createElement(M.Z,n()({},e,{title:o()(L.FormattedMessage,{defaultMessage:"Last used",id:"highlightSelectionButton.lastUsedSection.label"}),isTitleUppercase:!0}))},{key:1,items:i,render:e=>p().createElement(M.Z,n()({},e,{title:o()(L.FormattedMessage,{defaultMessage:"Color",id:"highlightSelectionButton.colorSection.label"}),isTitleUppercase:!0}))},{key:2,items:r,render:e=>p().createElement(M.Z,n()({},e,{title:o()(L.FormattedMessage,{defaultMessage:"Background",id:"highlightSelectionButton.backgroundSection.label"}),isTitleUppercase:!0}))}],initialFocus:void 0})}}))}})}getTextSelectionColor(){const e=(0,B.Ld)("h");return e?x.zI(e):"default"}getColorIconStyle(){const{device:e}=this.environment;return{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!e.isMobile&&{width:18,fontWeight:Z.Z.fontWeight.medium,marginBottom:2},...(0,P.A_)(this.getTextSelectionColor(),this.theme,(0,G.GN)())}}}const U=(0,L.injectIntl)(E)},82945:(e,t,s)=>{s.d(t,{Z:()=>M});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(67294)),p=s.n(l),u=s(7476),m=s(66832),c=s(37235),g=s(94610),h=s(3779),v=s(50906),f=s(24666),S=s(14947),y=s(5366);class b extends m.Z{constructor(...e){super(...e),d()(this,"handleClick",(e=>{const t=f.default.state;"editing"===t.mode&&u.WD({environment:this.environment,blockStore:this.props.blockStore,multiSelection:t.multiSelection}),v.mt_(this.environment,{action:"comment"})}))}renderComponent(){const{device:e}=this.environment,t=e.isMobile;return n()(c.Z,{renderTooltip:()=>n()(l.Fragment,{},void 0,n()("div",{},void 0,n()(y.FormattedMessage,{defaultMessage:"Comment on selected text",id:"inlineCommentButton.tooltip"})),n()("div",{},void 0,n()(g.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"comment"}))),render:e=>p().createElement(S.Z,o()({style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.props.style},disabled:this.props.disabled,disabledFeedback:this.props.disabled,onClick:this.handleClick},e),h.Z.speechBubbleThin({width:t?18:16,height:t?18:16,marginTop:t?0:1,marginRight:4}),!t&&n()(y.FormattedMessage,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"}))})}}const M=b},93007:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(98135),o=s.n(i),r=(s(33948),s(67294),s(66832));function n(){return(navigator.languages?navigator.languages.map((e=>e.toLowerCase())):navigator.language?[navigator.language.toLowerCase()]:navigator.userLanguage?[navigator.userLanguage.toLowerCase()]:[]).map((e=>e.split("-")[0]))}const a=["ar","az","he","fa","ur"];class d extends r.Z{renderComponent(){return this.renderTranslatedText()}renderTranslatedText(){const{translations:e}=this.props,t=n();for(const s of t){const t=e[s];if(t)return o()("div",{style:this.getTextStyle(s)},void 0,t)}}getTextStyle(e){return a.includes(e)?{direction:"rtl",...this.props.style}:{...this.props.style}}}const l=d},52796:(e,t,s)=>{s.d(t,{Z:()=>Y});var i=s(98135),o=s.n(i),r=(s(33948),s(67294)),n=s.n(r),a=s(89940),d=s(72087),l=s(78291),p=s(79092),u=s(79603),m=s(68932),c=s(1548),g=s(27386),h=s(42982),v=s(30045),f=s(1643),S=s(23189),y=s(5366),b=s(76725),M=s(58879),w=s(97880),P=s(95155),k=s(29368),Z=s(55422),C=s(27832),T=s(8646),I=s(9953),x=s(50906),F=s(74523),B=s(33665),L=s(88632),A=s(46951),G=s(35822),R=s(90031),E=s(38755),U=s(67154),D=s.n(U),O=s(86658),N=s(92108),z=s(10182),_=s(64215),V=s(3779),W=s(42001),j=s(12955);function K(){const e=(0,_.F)();return o()(z.Z,{hasDismissButton:!1,renderOrigin:t=>n().createElement(W.Z,D()({style:{paddingLeft:8,paddingRight:8}},t),o()(y.FormattedMessage,{id:"cookieSelector.label.customize",defaultMessage:"Customize"}),V.Z.chevronDown({width:10,marginLeft:4,fill:e.lightIconColor}))})}const H=function(){const e=(0,M.O7)(),t=(0,M.aq)("cookie-consent");return(0,j.canSetCookie)(e)?"on"!==t?null:o()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,o()("div",{style:{flex:1,marginRight:10}},void 0,o()(S.Z,{},void 0,n().createElement(y.FormattedMessage,O.ze.cookieSettingsLabel)),o()(A.Z,{isSmall:!0,isMultiline:!0},void 0,(0,O.Fd)(N.Tz,"settings"))),o()(K,{})):null};var q=s(97832);function Y({isMobile:e}){const{isElectron:t,isIOS:s}=(0,M.Fy)(),i=(0,M.O7)(),r=(0,a.VK)((()=>L.Z.state.online),[]),n=(0,a.VK)((()=>{var s,i;const r=(null===(s=C.default.state.currentSpaceViewStore)||void 0===s||null===(i=s.getValue())||void 0===i?void 0:i.notify_email)||!1;return function(e){const{isMobile:t,isElectron:s,showNotifyEmailAlwaysSetting:i}=e;return[{key:"notify_mobile",renderSettingsItem:()=>o()(Q,{target:"notify_mobile"})},!t&&s?{key:"notify_desktop",renderSettingsItem:()=>o()(Q,{target:"notify_desktop"})}:void 0,{key:"notify_email",renderSettingsItem:()=>o()(Q,{target:"notify_email"})},i?{key:"notify_email_always",renderSettingsItem:()=>o()(Q,{target:"notify_email_always"})}:void 0].filter(w.$K)}({isMobile:e,isElectron:t,showNotifyEmailAlwaysSetting:r})}),[e,t]),d=(0,a.VK)((()=>e?function({isIOS:e}){const{data:t}=l.default.state,s=e&&f.wY(t),i="on"===P.default.getGroup("user-data-consent"),r=(0,u.mS)(),n="on"===P.default.getGroup("mobile-delete-account");return[{key:"password",renderSettingsItem:()=>o()(ee,{})},{key:"cookies",renderSettingsItem:()=>o()(H,{})},{key:"appearance",renderSettingsItem:()=>o()(te,{isMobile:!0})},{key:"page-on-app-start",renderSettingsItem:()=>o()(se,{isMobile:!1})},s?{key:"subscription",renderSettingsItem:()=>o()(h.Z,{})}:void 0,i?{key:"user-consent",renderSettingsItem:()=>o()(v.Z,{})}:void 0,{key:"calendar",renderSettingsItem:()=>o()(p.Z,{})},r?{key:"experiments",renderSettingsItem:()=>o()(u.Pp,{})}:void 0,n?{key:"deleteAccount",renderSettingsItem:()=>o()(q.Z,{})}:void 0].filter(w.$K)}({isIOS:s}):[{key:"appearance",renderSettingsItem:()=>o()(te,{isMobile:!1})},{key:"page-on-app-start",renderSettingsItem:()=>o()(se,{isMobile:!1})},"on"===P.default.getGroup("cookie-consent")?{key:"cookies",renderSettingsItem:()=>o()(H,{})}:void 0].filter(w.$K)),[e,s]),{paddingBottomCSS:m}=(0,a.VK)((()=>i.WindowSizeStore.state),[i]);return r?o()(g.Z,{disableScroller:e},void 0,o()(S.Z,{large:!e,divider:"full"},void 0,o()(y.FormattedMessage,{id:"notificationAndPersonalSettings.notificationSection.title",defaultMessage:"My notifications"})),o()("div",{className:"notification-settings"},void 0,o()(J,{isMobile:e,items:n})),o()(k.Z,{size:48,isHidden:!0}),o()(S.Z,{large:!e,divider:"full"},void 0,o()(y.FormattedMessage,{id:"notificationAndPersonalSettings.settingsSection.title",defaultMessage:"My settings"})),o()("div",{className:"personal-settings"},void 0,o()(J,{isMobile:e,items:d})),o()(k.Z,{size:48,isHidden:!1}),o()("div",{style:{marginTop:4,marginBottom:e?m:void 0}},void 0,o()(F.Z,{title:o()(y.FormattedMessage,{id:"notificationSettings.helpButton.caption",defaultMessage:"Learn about notifications & settings"}),href:(0,B.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"}))):o()(g.Z,{},void 0,o()(A.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,o()(y.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"notificationSettingsButton.goOnline.prompt"})))}function J(e){const{isMobile:t,items:s}=e;return n().createElement(n().Fragment,null,(0,b.Z)(s.map((({key:e,renderSettingsItem:t})=>o()(n().Fragment,{},e,t()))),(e=>o()(k.Z,{size:t?32:18,isHidden:!t},e))))}function Q(e){const{target:t}=e,s=(0,M.O7)(),i=(0,a.VK)((()=>C.default.state.currentSpaceViewStore),[]),n=(0,a.VK)((()=>{var e;return(null==i||null===(e=i.getValue())||void 0===e?void 0:e[t])||!1}),[i,t]),d=(0,r.useCallback)((()=>{if(i){const e=!n;T.createAndCommit(s,(s=>{I.sW({store:i,data:{[t]:e},transaction:s})})),x.ygQ(s,{is_on:e,target:t})}}),[s,i,n,t]);return o()(Z.Z,{isMobile:!0,title:$(t),caption:X(t),type:"toggle",isOn:n,onToggle:d})}function $(e){return"notify_mobile"===e?o()(y.FormattedMessage,{id:"notificationSettings.mobilePushNotificationSettings.title",defaultMessage:"Mobile push notifications"}):"notify_desktop"===e?o()(y.FormattedMessage,{id:"notificationSettings.desktopNotificationSettings.title",defaultMessage:"Desktop push notifications"}):"notify_email"===e?o()(y.FormattedMessage,{id:"notificationSettings.emailNotificationSettings.title",defaultMessage:"Email notifications"}):"notify_email_always"===e?o()(y.FormattedMessage,{id:"notificationSettings.emailAlwaysNotificationSettings.title",defaultMessage:"Always send email notifications"}):void(0,w.t1)(e)}function X(e){return"notify_mobile"===e?o()(y.FormattedMessage,{id:"notificationSettings.mobilePushNotificationSettings.description",defaultMessage:"Receive push notifications on mentions and comments via your mobile app."}):"notify_desktop"===e?o()(y.FormattedMessage,{id:"notificationSettings.desktopNotificationSettings.description",defaultMessage:"Receive push notifications on mentions and comments immediately via your desktop app."}):"notify_email"===e?o()(y.FormattedMessage,{id:"notificationSettings.emailNotificationSettings.description",defaultMessage:"Receive email updates on mentions, comments, and edit digests for all the pages you have followed."}):"notify_email_always"===e?o()(y.FormattedMessage,{id:"notificationSettings.emailAlwaysNotificationSettings.description",defaultMessage:"Receive updates by email, even when you’re active on the app."}):void(0,w.t1)(e)}function ee(){const[e,,t]=(0,a.oR)(void 0,d.Z),s=(0,a.VK)((()=>{const{data:e}=l.default.state;return f.wl(e)}),[]);return e.loading?o()(m.Z,{}):o()(c.Z,{requestStore:t,isEducationPlan:s})}function te({isMobile:e}){const t=(0,M.O7)(),[s]=(0,a.oR)(t.ThemeStore),[i,r]=n().useState(G.MH(t,s.mode));return o()(Z.Z,{isMobile:e,title:o()(y.FormattedMessage,{id:"appearanceSettings.title",defaultMessage:"Appearance"}),caption:o()(y.FormattedMessage,{id:"appearanceSettings.description.message",defaultMessage:"Customize how Notion looks on your device."}),type:"dropdown",currentOption:i,options:[{key:"system",label:o()(y.FormattedMessage,{id:"appearanceSetting.system.label",defaultMessage:"Use system setting"})},{key:"light",label:o()(y.FormattedMessage,{id:"appearanceSetting.light.label",defaultMessage:"Light"})},{key:"dark",label:o()(y.FormattedMessage,{id:"appearanceSetting.dark.label",defaultMessage:"Dark"})}],onSelectOption:e=>{G.rz(t,e),r(e)}})}function se({isMobile:e}){const t=(0,M.O7)(),s=(0,a.VK)((()=>C.default.state.currentSpaceViewStore),[]),i=(0,a.VK)((()=>E.getOnAppStartPreference(s)),[s]);return o()(Z.Z,{isMobile:e,title:o()(y.FormattedMessage,{id:"pageOnAppStoreSetting.title",defaultMessage:"Open on start"}),caption:o()(y.FormattedMessage,{id:"pageOnAppStoreSetting.description.message",defaultMessage:"Choose what to show when Notion starts or when you switch workspaces."}),type:"dropdown",currentOption:i,options:[{key:"last_visited_page",label:o()(y.FormattedMessage,{id:"pageOnAppStoreSetting.lastVisitedPage.label",defaultMessage:"Last visited page"})},{key:"first_page",label:o()(y.FormattedMessage,{id:"pageOnAppStoreSetting.firstPage.label",defaultMessage:"Top page in sidebar"})}],onSelectOption:e=>{if(s){const i=(0,R._J)(s,s.pointer,["settings"]);T.createAndCommit(t,(t=>{I.sW({store:i,data:{on_app_start:e},transaction:t})}))}}})}},1548:(e,t,s)=>{s.d(t,{Z:()=>B});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(33948),s(67294)),d=s(5366),l=s(7765),p=s(66832),u=s(12318),m=s(27832),c=s(69503),g=s(58762),h=s(47307),v=s(43250),f=s(15102),S=s(62727),y=s(47966),b=s(72693),M=s(13490),w=s(8848),P=s(46951),k=s(33058),Z=s(69972),C=s(96068),T=s(23189),I=s(33954),x=s(50906);class F extends p.Z{constructor(...e){super(...e),n()(this,"storeTypes",{hasPasswordStore:u.Z.of(!1),emailStore:u.Z.of("")}),n()(this,"handleChangePasswordClick",(()=>{x.Wbl(this.environment),c.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:""})})),n()(this,"handleOldPasswordChange",(e=>{(c.Z.isSetNewPasswordModal()||c.Z.isRemovePasswordModal())&&c.Z.setState({...c.Z.state,oldPassword:e.target.value,alert:void 0})})),n()(this,"handleClearOldPassword",(()=>{(c.Z.isSetNewPasswordModal()||c.Z.isRemovePasswordModal())&&c.Z.setState({...c.Z.state,oldPassword:"",alert:void 0})})),n()(this,"handlePasswordChange",(e=>{c.Z.isSetNewPasswordModal()&&c.Z.setState({...c.Z.state,password:e.target.value,alert:void 0})})),n()(this,"handleCancelChangePassword",(()=>{const{onCancel:e}=c.Z.state;c.Z.reset(),e&&e()})),n()(this,"handleClearPassword",(()=>{c.Z.isSetNewPasswordModal()&&c.Z.setState({...c.Z.state,password:"",repeatPassword:"",alert:void 0})})),n()(this,"handleRepeatPasswordChange",(e=>{c.Z.isSetNewPasswordModal()&&c.Z.setState({...c.Z.state,repeatPassword:e.target.value,alert:void 0})})),n()(this,"handleClearRepeatPassword",(()=>{c.Z.isSetNewPasswordModal()&&c.Z.setState({...c.Z.state,repeatPassword:"",alert:void 0})})),n()(this,"handlePasswordBlur",(()=>{if(c.Z.isSetNewPasswordModal()){const{password:e,repeatPassword:t}=c.Z.state;e&&t&&e!==t&&c.Z.setState({...c.Z.state,alert:this.props.intl.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordMismatchError",defaultMessage:"Your new password does not match."})})}})),n()(this,"handleSubmit",(async()=>{if(!c.Z.isSetNewPasswordModal())return;const{oldPassword:e,password:t,repeatPassword:s}=c.Z.state,i=this.stores.hasPasswordStore.get(),{intl:o}=this.props;let r;if(i&&!e)r=o.formatMessage({id:"passwordSettings.changePasswordModal.oldPasswordMissingError",defaultMessage:"Please enter your old password."});else if(t){const e=(0,C.I)(t);e.success?s?t!==s&&(r=o.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordsMismatchError",defaultMessage:"Your passwords do not match."})):r=o.formatMessage({id:"passwordSettings.changePasswordModal.newPasswordNotRepeatedError",defaultMessage:"Please repeat your new password."}):r=this.getPasswordErrorMessage(e.reason)}else r=o.formatMessage({id:"passwordSettings.changePasswordModal.passwordNotEnteredError",defaultMessage:"Please enter a password."});if(r)return void c.Z.setState({...c.Z.state,alert:r});const n=await g.setPassword(this.environment,{oldPassword:e,newPassword:t});if("success"===n.type)this.props.requestStore.refresh(),void 0===e?this.saveNewPasswordSuccess():this.changePasswordSuccess();else{const e=(0,I.wf)(this.props.intl,n);c.Z.setState({...c.Z.state,alert:e})}})),n()(this,"handleShowRemovePasswordModalClick",(()=>{c.Z.setState({open:!0,removePassword:!0,oldPassword:""})})),n()(this,"handleRemovePasswordClick",(async()=>{if(!c.Z.isRemovePasswordModal())return;const{oldPassword:e}=c.Z.state;if(x.wrY(this.environment),!e)return void c.Z.setState({...c.Z.state,alert:this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.oldPasswordNotEnteredError",defaultMessage:"Please enter your current password.",description:"We require users to enter their password in a text box before they can delete it. This error message appears if the user attempts to delete their password but hasn't entered it into the text box."})});const t=await g.setPassword(this.environment,{oldPassword:e,clearPassword:!0});if("success"===t.type)this.props.requestStore.refresh(),this.removePasswordSuccess();else{const e=(0,I.wf)(this.props.intl,t);c.Z.setState({...c.Z.state,alert:e||this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.message",defaultMessage:"Error removing password. Please try again later."})})}})),n()(this,"defaultErrorMessage",this.props.intl.formatMessage({id:"passwordSettings.genericPasswordSaveError",defaultMessage:"Error saving password. Please try again later."}))}willMount(e){super.willMount(e);const{currentUserStore:t}=m.default.state;if(t){const e=t.getValue();e&&this.stores.emailStore.set(e.email)}}renderComponent(){const e=this.stores.emailStore.get();if(!e)return;const{requestStore:t}=this.props;return o()("div",{style:this.getSettingsOptionStyle()},void 0,o()(T.Z,{smallMarginBottom:!0},void 0,o()(d.FormattedMessage,{id:"passwordSettings.title",defaultMessage:"Password"})),o()(l.Z,{request:{},requestStore:t,performRequest:async()=>{const t=await g.checkEmailType(this.environment,{email:e,allowAdminBypass:!0});if("success"===t.type){const{samlRedirect:e,hasPassword:s}=t.data;return{samlEnforced:e&&e.enforced,hasPassword:s}}throw t.error},render:(e,t)=>{if(e)return F.renderLabel(o()(d.FormattedMessage,{id:"passwordSettings.passwordSetError.message",defaultMessage:"Your password cannot be set at this time. Please try again later."}));if(t){const{samlEnforced:e,hasPassword:s}=t;return e?F.renderLabel(o()(d.FormattedMessage,{id:"passwordSettings.passwordManagedThroughSAMLProvider.message",defaultMessage:"Your password is managed through your SAML Single Sign-on Provider.",description:"Message letting users know that their password is managed through a 3rd-party provider, which is why they can't set their password on Notion's password settings page."})):(this.stores.hasPasswordStore.set(Boolean(s)),this.renderPasswordActions())}}}))}renderPasswordActions(){const{isEducationPlan:e}=this.props,t=this.stores.hasPasswordStore.get();return o()(a.Fragment,{},void 0,F.renderLabel(o()(d.FormattedMessage,{id:"passwordSettings.passwordSetInstructions",defaultMessage:"You can set a permanent password if you don't want to use temporary login codes."})),e&&F.renderLabel(this.renderEducationPlanInfo()),o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()(y.Z,{isLarge:!0,onClick:this.handleChangePasswordClick,style:{marginTop:12,marginBottom:4}},void 0,o()(d.FormattedMessage,t?{id:"passwordSettings.changePasswordButton.label",defaultMessage:"Change password"}:{id:"passwordSettings.setPasswordButton.label",defaultMessage:"Set a password"})),this.canRemovePassword()&&o()(k.Z,{onClick:this.handleShowRemovePasswordModalClick,style:{marginLeft:5,marginTop:12,marginBottom:4}},void 0,o()(d.FormattedMessage,{id:"passwordSettings.removePasswordButton.label",defaultMessage:"Remove password"}))),this.renderPasswordModal())}static renderLabel(e){return o()(P.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,e)}renderPasswordModal(){const{device:e}=this.environment,{open:t}=c.Z.state;return o()(f.Z,{open:t,onDismiss:this.handleCancelChangePassword,innerStyle:{width:e.isPhone?"90%":460,minHeight:270,padding:24},className:v.BK,preventHideChildrenWhileOpening:!0,render:()=>o()(Z.Z,{capture:!0,allowEsc:!0,render:()=>o()(a.Fragment,{},void 0,this.renderSaveNewPassword(),this.renderRemovePassword())})})}renderSaveNewPassword(){const{isEducationPlan:e}=this.props;if(!c.Z.isSetNewPasswordModal())return;const{password:t,repeatPassword:s,oldPassword:i,alert:r}=c.Z.state,n=this.stores.hasPasswordStore.get(),l=this.stores.emailStore.get();return o()(a.Fragment,{},void 0,o()(S.Z,{style:{display:"none"},type:"text",value:l,autoComplete:"username",disabled:!0}),n&&o()(a.Fragment,{},void 0,o()(M.Z,{},void 0,o()(d.FormattedMessage,{id:"passwordSettings.changePasswordModal.oldPasswordInput.label",defaultMessage:"Old Password"})),o()(S.Z,{type:"password",value:i,onChange:this.handleOldPasswordChange,showClearButton:!0,onClearButtonClick:this.handleClearOldPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.oldPasswordInput.placeholder",defaultMessage:"Enter old password..."}),style:{padding:"4px 8px"},focusInitial:!0,autoComplete:"current-password"})),n?o()(M.Z,{hasMarginTop:!0},void 0,o()(d.FormattedMessage,{id:"passwordSettings.newPasswordInput.label",defaultMessage:"New password"})):o()(M.Z,{},void 0,o()(d.FormattedMessage,{id:"passwordSettings.passwordInput.label",defaultMessage:"Password"})),o()(S.Z,{type:"password",value:t,onChange:this.handlePasswordChange,onSubmit:this.handleSubmit,showClearButton:!0,onClearButtonClick:this.handleClearPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.newPasswordInput.placeholder",defaultMessage:"Enter new password..."}),style:{padding:"4px 8px"},focusInitial:!n,onBlur:this.handlePasswordBlur,autoComplete:"new-password"}),o()(M.Z,{hasMarginTop:!0},void 0,o()(d.FormattedMessage,{id:"passwordSettings.repeatPasswordInput.label",defaultMessage:"Repeat password"})),o()(S.Z,{type:"password",value:s,onChange:this.handleRepeatPasswordChange,onSubmit:this.handleSubmit,showClearButton:!0,onClearButtonClick:this.handleClearRepeatPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.repeatPasswordInput.placeholder",defaultMessage:"Repeat new password..."}),style:{padding:"4px 8px"},onBlur:this.handlePasswordBlur,autoComplete:"new-password"}),o()(P.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginTop:14}},void 0,o()(d.FormattedMessage,{id:"passwordSettings.passwordGuidelines",defaultMessage:"Use a password at least 15 letters long, or at least 8 characters long with both letters and numbers."})),e&&o()(P.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginTop:14}},void 0,this.renderEducationPlanInfo()),this.renderAlert(r),o()(b.Z,{isLarge:!0,style:{marginTop:14},onClick:this.handleSubmit},void 0,o()(d.FormattedMessage,n?{id:"passwordSettings.changePasswordButton.label",defaultMessage:"Change password"}:{id:"passwordSettings.setPasswordButton.label",defaultMessage:"Set a password"})))}renderRemovePassword(){const{isEducationPlan:e}=this.props;if(!c.Z.isRemovePasswordModal())return;const{oldPassword:t,alert:s}=c.Z.state;return o()(a.Fragment,{},void 0,o()("div",{style:{fontSize:14,width:"100%"}},void 0,o()(d.FormattedMessage,{id:"passwordSettings.removePasswordModal.text",defaultMessage:"You're about to remove your password. We'll email you temporary login codes to access Notion going forward.",description:"Message warning the user that they're about to delete their password, and telling them how to log in after their password has been deleted."}),e&&o()(d.FormattedMessage,{id:"passwordSettings.removePasswordModal.educationPlanWarning",defaultMessage:"If you lose access to your school email, you'll be unable to log back into Notion.",description:"Warning for users on the Education Plan that if they lose access to their school email, they won't be able to log into Notion without a password."})),o()(M.Z,{hasMarginTop:!0},void 0,o()(d.FormattedMessage,{id:"passwordSettings.deletePasswordModal.passwordInput.label",defaultMessage:"Password"})),o()(S.Z,{type:"password",value:t,onChange:this.handleOldPasswordChange,onSubmit:this.handleRemovePasswordClick,showClearButton:!0,onClearButtonClick:this.handleClearOldPassword,placeholder:this.props.intl.formatMessage({id:"passwordSettings.removePasswordModal.passwordInput.placeholder",defaultMessage:"Enter your password..."}),style:{padding:"4px 8px"},focusInitial:!0,autoComplete:"current-password"}),this.renderAlert(s),o()(b.Z,{isLarge:!0,style:{marginTop:14},onClick:this.handleRemovePasswordClick},void 0,o()(d.FormattedMessage,{id:"passwordSettings.removePasswordModal.removePasswordButton.label",defaultMessage:"Remove password"})))}renderAlert(e){if(e)return o()(P.Z,{isMultiline:!0,style:{marginTop:8,color:w.ZP.red}},void 0,e)}renderEducationPlanInfo(){return o()(d.FormattedMessage,{id:"passwordSettings.educationPlanGuidelines",defaultMessage:"If you lose access to your school email address, you'll be able to log in using your password."})}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}saveNewPasswordSuccess(){const{intl:e,isEducationPlan:t}=this.props,{onSubmit:s}=c.Z.state;c.Z.reset();const i=t?e.formatMessage({id:"passwordSettings.setPasswordSuccess.educationMessage",defaultMessage:"Your password is all set! You'll be able to log in, even if you lose access to your school email address."}):e.formatMessage({id:"passwordSettings.setPasswordSuccess.message",defaultMessage:"Your password is all set!"});h.showMessage({message:i,onAccept:s})}changePasswordSuccess(){const{onSubmit:e}=c.Z.state;c.Z.reset(),h.showMessage({message:this.props.intl.formatMessage({id:"passwordSettings.changePasswordSuccess.message",defaultMessage:"Your new password has been saved."}),onAccept:e})}removePasswordSuccess(){c.Z.reset(),h.showMessage({message:this.props.intl.formatMessage({id:"passwordSettings.removePasswordSuccess.message",defaultMessage:"Your password has been removed."})})}getPasswordErrorMessage(e){const t=I.Ql[e.type];return t?this.props.intl.formatMessage(t):this.defaultErrorMessage}canRemovePassword(){const{isEducationPlan:e}=this.props,t=this.stores.hasPasswordStore.get();return!e&&t}}const B=(0,d.injectIntl)(F)},40464:(e,t,s)=>{s.d(t,{Z:()=>b});var i=s(98135),o=s.n(i),r=s(67154),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(67294)),p=s.n(l),u=s(98724),m=s(66832),c=s(37235),g=s(50906),h=s(24666),v=s(14947),f=s(8848),S=s(89086);class y extends m.Z{constructor(...e){super(...e),d()(this,"handleClick",(e=>{u.aS({environment:this.environment,annotation:[this.props.type]}),this.props.onClick&&this.props.onClick(),g.mt_(this.environment,{action:this.props.type})})),d()(this,"isDisabledStore",this.createComputedStore((()=>this.props.disabled||"editing"!==h.default.state.mode)))}renderComponent(){return o()(c.Z,{renderTooltip:()=>this.props.tooltipLabel,render:e=>p().createElement(v.Z,n()({style:this.getButtonStyle(),disabled:this.isDisabledStore.state,disabledFeedback:this.isDisabledStore.state,onClick:this.handleClick},e),this.props.children)})}getButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",color:(0,S.Ld)(this.props.type)?f.ZP.blue:this.theme.regularTextColor,...this.props.style}}}const b=y},32404:(e,t,s)=>{s.d(t,{Z:()=>w});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(67294)),p=s.n(l),u=s(70203),m=s(14947),c=s(36280),g=s(66949),h=s(89086),v=s(5366),f=s(94610),S=s(66832),y=s(37235),b=s(24666);class M extends S.Z{constructor(...e){super(...e),d()(this,"renderMenuTooltip",(()=>{const e=this.getThemeColors();return n()(p().Fragment,{},void 0,n()("div",{},void 0,n()(v.FormattedMessage,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Create equation"})),n()("div",{},void 0,n()(f.Z,{style:e.keyboardShortcut,name:"openEquationMenu"})))})),d()(this,"handleButtonPopupClick",(e=>{const{onClick:t}=this.props;c.qn({environment:this.environment,analyticsFrom:"rich_text_menu"}),t&&t(e)})),d()(this,"isSelected",(()=>(0,h.Ld)(u.GK.Equation))),d()(this,"isDisabled",(()=>{const{disabled:e}=this.props;if(e)return!0;if("editing"!==b.default.state.mode&&!g.Z.isOpen())return!0;const t={[u.GK.User]:u.GK.User,[u.GK.Page]:u.GK.Page,[u.GK.Bot]:u.GK.Bot,[u.GK.Date]:u.GK.Date,[u.GK.ExternalObjectInstance]:u.GK.ExternalObjectInstance,[u.GK.TemporaryPage]:u.GK.TemporaryPage,[u.GK.TemplateVariable]:u.GK.TemplateVariable};for(const s of Object.values(t))if((0,h.J6)(s))return!0;return!1})),d()(this,"styles",{equationButton:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8}})}renderComponent(){const{style:e,children:t}=this.props,s=this.getThemeColors(),i=this.isDisabled();return n()(y.Z,{renderTooltip:this.renderMenuTooltip,render:r=>p().createElement(m.Z,o()({style:{...this.styles.equationButton,...s.equationButton,...e},disabled:i,disabledFeedback:i,onClick:this.handleButtonPopupClick},r),t)})}getThemeColors(){return{equationButton:{color:this.isSelected()?this.theme.blueColor:this.theme.regularTextColor},keyboardShortcut:{color:this.theme.mediumInvertedTextColor}}}}const w=(0,v.injectIntl)(M)},73383:(e,t,s)=>{s.d(t,{Z:()=>P});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(67294)),p=s.n(l),u=s(45990),m=s(66832),c=s(37235),g=s(94610),h=s(50906),v=s(14947),f=s(24666),S=s(23178),y=s(89086),b=s(5366),M=s(70203);class w extends m.Z{constructor(...e){super(...e),d()(this,"handleButtonPopupClick",(()=>{u.dz({type:"focusOnly",focus:!0}),h.mt_(this.environment,{action:M.GK.Link})}))}renderComponent(){const e=(0,y.Ld)(M.GK.Link),t=this.isDisabled();return n()(c.Z,{renderTooltip:()=>n()(l.Fragment,{},void 0,n()("div",{},void 0,n()(b.FormattedMessage,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip",description:"Prompt for the user to add a URL to link to from the selected text."})),n()("div",{},void 0,n()(g.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openLinkMenu"}))),render:s=>p().createElement(v.Z,o()({style:{display:"flex",alignItems:"center",borderRadius:0,paddingLeft:7,paddingRight:8,...e&&{color:this.theme.blueColor},whiteSpace:"nowrap",...this.props.style},disabled:t,disabledFeedback:t},s,{onClick:this.handleButtonPopupClick}),this.props.children)})}isDisabled(){return!!this.props.disabled||("editing"!==f.default.state.mode&&!S.Z.state.open||!!((0,y.J6)(M.GK.User)||(0,y.J6)(M.GK.Bot)||(0,y.J6)(M.GK.Date)||(0,y.J6)(M.GK.Page)))}}const P=(0,b.injectIntl)(w)},27386:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(98135),o=s.n(i),r=(s(67294),s(29368)),n=s(592),a=s(66832);class d extends a.Z{static renderDivider(){return o()(r.Z,{size:37})}renderComponent(){const{device:e}=this.environment,{children:t,controlRow:s,paddingLeftRight:i}=this.props,r=()=>i||(e.isMobile?18:60),a=()=>e.isMobile?18:36;return this.props.disableScroller?o()("div",{style:{paddingLeft:r(),paddingRight:r()}},void 0,o()("div",{style:{paddingTop:a(),paddingBottom:a()}},void 0,t),s&&o()("div",{style:{paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,s)):o()("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%",backgroundColor:this.theme.cardContentBackground}},void 0,o()(n.ZP,{type:n.xm.All,style:{flexGrow:1,WebkitOverflowScrolling:"touch",transform:"translateZ(0)",paddingLeft:r(),paddingRight:r(),paddingTop:a(),paddingBottom:a()}},void 0,t),s&&o()("div",{style:{flexGrow:0,flexShrink:0,paddingLeft:r(),paddingRight:r(),paddingTop:16,paddingBottom:16,boxShadow:"0 -1px 0 ".concat(this.theme.regularDividerColor)}},void 0,s))}}const l=d},55422:(e,t,s)=>{s.d(t,{Z:()=>T});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=(s(41817),s(5366)),d=s(67294),l=s.n(d),p=s(3779),u=s(97880),m=s(58879),c=s(89940),g=s(64215),h=s(48762),v=s(46167),f=s(71202),S=s(25584),y=s(47966),b=s(83071),M=s(23189),w=s(47714),P=s(46951),k=s(61543),Z=s(93678),C=s(86646);function T(e){const{title:t,caption:s,isMobile:i,upsellOptions:o,type:r}=e,a=(0,m.O7)(),{paddingLeftCSS:d,paddingRightCSS:p}=(0,c.VK)((()=>a.WindowSizeStore.state),[a]),u=(0,g.y)((()=>({container:{...i&&"dropdown"===r?{display:"flex",flexDirection:"column"}:{display:"flex",alignItems:"center",justifyContent:"space-between"},paddingLeft:i?d:void 0,paddingRight:i?p:void 0},description:{display:"flex",flexDirection:"column",marginRight:"10%"}})),[i,r,d,p]);return n()("div",{style:u.container,onClick:()=>{if(o&&o.shouldUpsell)return Z.y(a,{from:o.analyticsName,for:o.subscriptionTier});"toggle"===e.type&&e.onToggle()}},void 0,n()("div",{style:u.description},void 0,n()(M.Z,{smallMarginBottom:!0},void 0,t,o&&o.shouldUpsell&&n()(k.Z,{subscriptionTier:o.subscriptionTier,analyticsName:o.analyticsName,onClick:()=>Z.y(a,{from:o.analyticsName,for:o.subscriptionTier}),desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}})),n()(P.Z,{isSmall:!0,isMultiline:!0},void 0,s)),l().createElement(I,e))}function I(e){const{isAndroid:t}=(0,m.Fy)();return"toggle"===e.type?n()(w.Z,{on:e.isOn,isAndroid:t}):"dropdown"===e.type?l().createElement(x,e):void(0,u.t1)(e)}function x(e){var t;const{isMobile:s,title:i,upsellOptions:r,currentOption:d,options:u,info:m,onSelectOption:c}=e,M=null===(t=u.find((({key:e})=>e===d)))||void 0===t?void 0:t.label,w=(0,g.y)((e=>({button:{marginTop:12,marginBottom:4,marginRight:s?"auto":void 0},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[s]),P=Boolean(r&&r.shouldUpsell);return n()(v.Z,{popupType:s?v.Z.PopupType.SlideUp:v.Z.PopupType.Popup,placementToOrigin:v.Z.Placement.Right,renderOrigin:e=>l().createElement(y.Z,o()({},e,{isLarge:!0,style:{...w.button,opacity:P?.4:1},disabled:P}),M,p.Z.chevronDown(w.icon)),render:e=>{let t;t=s?{menuType:f.ZP.MenuType.Modal,title:i,right:n()(a.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:e.close}:{menuType:f.ZP.MenuType.Popup,width:250};const r=[{key:"settings-item-section",render:e=>l().createElement(b.Z,e),items:u.map((({key:t,label:i,caption:r})=>({key:t,action:()=>{c(t),e.close()},render:e=>l().createElement(h.Z,o()({},e,{title:i,caption:r,shouldWrapCaption:!0,right:M===i?n()("div",{style:{width:s?16:14}},void 0,p.Z.check()):void 0}))})))}];if(m){const e=m.map((({key:e,label:t})=>({key:e,action:()=>{},render:e=>l().createElement(C.Z,o()({},e,{shouldWrapCaption:!0,caption:t}))})));r.push({key:"info-item-section",render:e=>l().createElement(b.Z,o()({},e,{topBorder:!0})),items:e})}return l().createElement(f.ZP,t,n()(S.Z,{type:S.Z.Type.Vertical,sections:r,initialFocus:void 0}))}})}},58280:(e,t,s)=>{s.d(t,{Z:()=>st});var i=s(67154),o=s.n(i),r=s(98135),n=s.n(r),a=s(59713),d=s.n(a),l=(s(33948),s(96486)),p=s.n(l),u=s(67294),m=s.n(u),c=s(58059),g=s(27006),h=s(19889),v=s(76464),f=s(29974),S=s(31942),y=s(64404),b=s(38978),M=s(66832),w=s(29368),P=s(26111),k=s(9714),Z=s(61766),C=s(46167),T=s(25584),I=s(71202),x=s(24042),F=s(83071),B=s(16328),L=s(47307),A=s(58762),G=s(21325),R=s(84210),E=s(8646),U=s(37235),D=s(86646),O=s(50906),N=s(92625),z=s(47966),_=s(42001),V=s(3779),W=s(1643),j=s(78291),K=s(5366),H=s(21202);const q=(0,K.defineMessages)({removingGuest:{id:"guestPagesPopup.removeGuest.updatingMessage",defaultMessage:"Updating…"},addingMember:{id:"guestPagesPopup.addMemberPermission.updatingMessage",defaultMessage:"Updating…"}});class Y extends M.Z{constructor(...e){super(...e),d()(this,"storeTypes",{buttonPopupStore:Z.Z}),d()(this,"renderPopup",(()=>{const{device:e}=this.environment,{store:t,guest:s}=this.props,i=t.canAdmin(),r=s.guestPageIds.map((e=>{const s=k.Z.createChildStore(t,{table:H.iU,id:e});return{key:e,render:e=>m().createElement(x.Z,o()({},e,{store:s,placeholder:n()(K.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"})})),action:()=>{const s=k.Z.createChildStore(t,{table:H.iU,id:e}),i=(0,R.Z)({store:s,fullyQualified:!1});P.navigate({environment:this.environment,url:i,metaClick:!0})}}}));let a,d;return a=e.isMobile?{menuType:I.ZP.MenuType.ActionSheet}:{menuType:I.ZP.MenuType.Popup,width:300},(0,W.qF)(this.environment)&&(d=n()(U.Z,{renderTooltip:()=>this.isSubscribed()?n()(K.FormattedMessage,{id:"guestPagesPopup.addMemberPermissionButton.tooltip",defaultMessage:"This guest will become a member of this workspace."}):n()(K.FormattedMessage,{id:"guestPagesPopup.addAdminPermissionButton.tooltip",defaultMessage:"This guest will become an admin of this workspace."}),render:e=>m().createElement(z.Z,o()({isLarge:!0,onClick:this.handleConvertToMemberClick},e),this.isSubscribed()?n()(K.FormattedMessage,{id:"guestPagesPopup.addMemberPermissionButton.label",defaultMessage:"Convert to member"}):n()(K.FormattedMessage,{id:"guestPagesPopup.addAdminPermissionButton.label",defaultMessage:"Convert to admin"}))})),m().createElement(I.ZP,a,i&&n()(D.Z,{title:n()("div",{style:{paddingTop:12,paddingBottom:8,display:"flex",alignItems:"flex-start"}},void 0,d,n()(U.Z,{renderTooltip:()=>n()(K.FormattedMessage,{id:"guestPagesPopup.removeGuestButton.tooltip",defaultMessage:"This guest will be removed from all pages in this Workspace."}),render:e=>m().createElement(z.Z,o()({isLarge:!0,isRed:!0,style:{marginLeft:d?8:0},onClick:this.handleRemoveClick},e),n()(K.FormattedMessage,{id:"guestPagesPopup.removeGuestButton.label",defaultMessage:"Remove"}))}))}),i&&n()(B.Z,{title:n()(K.FormattedMessage,{id:"guestPagesPopup.guestAccessiblePagesCaption",defaultMessage:"This guest can access these pages"})}),n()(T.Z,{type:T.Z.Type.Vertical,initialFocus:0,sections:[{key:"pages",render:e=>m().createElement(F.Z,e),items:r}]}))})),d()(this,"handleRemoveClick",(()=>{L.showDialog({showCancel:!0,keepFocus:!1,message:n()(K.FormattedMessage,{id:"guestPagesPopup.removeGuestModal.confirmationMessage",defaultMessage:"Are you sure you want to remove this person? They will lose access to all shared pages."}),items:[{label:n()(K.FormattedMessage,{id:"guestPagesPopup.removeGuestModal.removeButton.label",defaultMessage:"Remove"}),color:"red",onAccept:async()=>{const{guest:e,store:t}=this.props;this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),N.j({message:q.removingGuest});"success"===(await A.removeUsersFromSpace(this.environment,{userIds:[e.userId],spaceId:t.id,removePagePermissions:!0,revokeUserTokens:!1})).type&&(await G.bi(this.environment),O.bwR(this.environment)),N.x()}}]})})),d()(this,"handleConvertToMemberClick",(async()=>{const e=E.create(this.environment),{store:t,guest:s,isSubscribed:i}=this.props,o=v.ep({environment:this.environment,store:t,permissionItems:[{type:"user_permission",role:i?"read_and_write":"editor",user_id:s.userId}],transaction:e});E.commit({environment:this.environment,transaction:e}),this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),N.j({message:q.addingMember});try{await o,await G.bi(this.environment),O.Rbv(this.environment,{member_user_id:s.userId})}finally{N.x()}}))}renderComponent(){const{device:e}=this.environment,{buttonPopupStore:t}=this.stores,{store:s,guest:i}=this.props;return i.guestPageIds.map((e=>{k.Z.createChildStore(s,{table:H.iU,id:e}).getValue()})),0===i.guestPageIds.length?n()(K.FormattedMessage,{id:"guestPagesPopup.permissionsForUserGuest.label",defaultMessage:"Guest"}):n()(C.Z,{popupType:e.isMobile?C.Z.PopupType.SlideUp:C.Z.PopupType.Popup,renderOrigin:e=>m().createElement(_.Z,e,n()(K.FormattedMessage,{id:"guestPagesButton.label",defaultMessage:"{numberOfAccessiblePages, plural, one {{numberOfAccessiblePages} page} other {{numberOfAccessiblePages} pages}}",values:{numberOfAccessiblePages:i.guestPageIds.length}}),V.Z.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})),buttonPopupStore:t,render:this.renderPopup})}isSubscribed(){const{data:e}=j.default.state;return Boolean(e&&(0,W.YK)(e))}}const J=(0,K.injectIntl)(Y);var Q=s(62727),$=s(7567),X=s(27386),ee=s(40235),te=s(66957),se=s(75246),ie=s(41493),oe=s(40039),re=s(52016);class ne extends re.Z{getInitialState(){return{userInputValue:"",temporaryUserIds:[],limitUsers:!0}}}const ae=ne;var de=s(66722),le=s(58945),pe=s(44517),ue=s(7765),me=s(31299),ce=s(97680),ge=s(47082),he=s(13548),ve=s(31792),fe=s(69152),Se=s(12534),ye=s(62619),be=s(89206),Me=s(49312),we=s(82990),Pe=s(22808),ke=s(22294),Ze=s(72693),Ce=s(80527),Te=s(33728),Ie=s(27832),xe=s(43997),Fe=s(16639),Be=s(90965),Le=s(26524),Ae=s(8848);class Ge extends M.Z{constructor(...e){super(...e),d()(this,"storeTypes",{spacePermissionGroupStore:ae,actionMenuButtonPopupStore:Z.Z,addMemberButtonPopupStore:Z.Z,autocompleteStore:pe.Z,mouseStore:ve.Z}),d()(this,"renderUser",(e=>{const{store:t,group:s,disabled:i}=this.props,o=!!t.state.value&&(0,Be.wv)(t.state.value,e.id);return n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},e.id,n()("div",{style:{display:"flex"}},void 0,n()(ie.Z,{userValue:e,style:{paddingRight:6,minHeight:34,lineHeight:1.2,width:"100%"},avatarSize:24}),o&&n()(Le.Z,{},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.user.admin",defaultMessage:"Admin"}))),!i&&n()(_.Z,{isGray:!0,hoveredStyle:{color:Ae.ZP.red},onClick:async()=>{if(await L.confirmUserAction({message:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationMessage",defaultMessage:"Are you sure you want to remove this member?"}),acceptLabel:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupDialog.confirmationButton.label",defaultMessage:"Yes"})})){const i=(s.user_ids||[]).filter((t=>t!==e.id)),o={...s,user_ids:i};E.createAndCommit(this.environment,(e=>{f.jF({spaceStore:t,group:o,transaction:e})})),O.xtf(this.environment)}}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.removeMemberFromGroupButton.label",defaultMessage:"Remove"})))})),d()(this,"renderActionMenu",(()=>{const e={key:"action_menu",render:e=>m().createElement(F.Z,e),items:[{key:"rename",render:e=>m().createElement(le.Z,o()({},e,{title:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.renameItem",defaultMessage:"Rename"})})),action:this.handleRename},{key:"delete",render:e=>m().createElement(le.Z,o()({},e,{title:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.actionMenu.deleteItem",defaultMessage:"Delete"})})),action:this.handleDelete}]};return n()(I.ZP,{menuType:I.ZP.MenuType.Popup},void 0,n()(T.Z,{type:T.Z.Type.Vertical,initialFocus:0,sections:[e],onAccept:()=>{this.stores.actionMenuButtonPopupStore.reset()}}))})),d()(this,"renderAddMemberMenu",(()=>{const{store:e}=this.props,{userInputValue:t,temporaryUserIds:s}=this.stores.spacePermissionGroupStore.state,i={request:{query:t,temporaryUserIds:this.stores.spacePermissionGroupStore.state.temporaryUserIds},performRequest:async({query:e,temporaryUserIds:t})=>{const{group:s}=this.props,i=s.user_ids||[];return(await me.O$({environment:this.environment,query:e,membersOnly:!0})).filter((e=>i.indexOf(e.id)<0&&t.indexOf(e.id)<0)).slice(0,20)},render:this.renderAddMemberResults},o=s.map((t=>{const i=e.getRecordValue({table:h.KJ,id:t});return n()(xe.vw,{userValue:i,format:xe.vw.Format.Medium,showRemoveButton:!0,onClickRemove:()=>{const e=s.filter((e=>e!==t));this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:e})},shouldShrink:!0,isSingle:!1},t)}));return n()(I.ZP,{menuType:I.ZP.MenuType.Popup,tokenInputHeader:!0,header:n()(ge.Z,{focus:!0,disabled:!1,focusAfterAnimation:!0,format:ge.Z.Format.Group,tokens:o,placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.userSearchInput.placeholder",defaultMessage:"Search for a person…"}),onRemoveLastToken:this.handleTokenInputMenuItemRemoveLastToken,value:t,onChange:this.handleTokenInputMenuItemChange,inputAndTokenWrapRightStyle:{paddingTop:this.environment.device.isMobile?0:6,paddingBottom:this.environment.device.isMobile?0:6},right:n()(Ze.Z,{isLarge:!0,onClick:this.handleAddDoneClick},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.addUserButton.label",defaultMessage:"Add"}))})},void 0,m().createElement(ue.Z,i))})),d()(this,"renderAddMemberResults",((e,t)=>{const{store:s}=this.props,i=t||[],{temporaryUserIds:r}=this.stores.spacePermissionGroupStore.state,a=i.map((({id:e})=>e));if(0===a.length)return n()(F.Z,{},void 0,n()(B.Z,{title:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.searchUserDropdown.noResultsMessage",defaultMessage:"No results"})}));{const e={key:"user_menu",render:e=>m().createElement(F.Z,e),items:a.map((e=>{const t=b.Z.createChildStore(s,{table:h.KJ,id:e}).getValue();return{key:e,render:e=>m().createElement(ce.Z,o()({},e,{user:t})),action:()=>{const t=[...r,e];this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:t,userInputValue:""})}}}))};return n()(T.Z,{type:T.Z.Type.Vertical,initialFocus:0,sections:[e]})}})),d()(this,"handleMouseEnter",(e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})})),d()(this,"handleMouseLeave",(e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})})),d()(this,"handleMouseDown",(e=>{(0,ye.sh)(e.target,(e=>e&&e.classList&&e.classList.contains(Ge.dragHandleClass)))||(0,Se.$0)(e)})),d()(this,"handleIconChange",(e=>{const{store:t,group:s}=this.props,i={...s,icon:e};E.createAndCommit(this.environment,(e=>{f.jF({spaceStore:t,group:i,transaction:e})})),O.zUE(this.environment,{is_emoji:(0,Pe.Z)(e)})})),d()(this,"handleRename",(()=>{const{group:e,spacePermissionsSettingsStore:t}=this.props;t.setState({...t.state,editingNameGroupId:e.id,groupNameInputValue:e.name||""}),this.stores.actionMenuButtonPopupStore.setState({...this.stores.actionMenuButtonPopupStore.state,open:!1}),O.XbW(this.environment)})),d()(this,"handleDelete",(async()=>{const{store:e,group:t}=this.props;this.stores.actionMenuButtonPopupStore.setState({...this.stores.actionMenuButtonPopupStore.state,open:!1});if(await L.confirmUserAction({message:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationMessage",defaultMessage:"Are you sure you want to delete this group? Any pages that are private to this group will be transferred to you."}),acceptLabel:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.deleteGroupModal.confirmationButton.label",defaultMessage:"Yes"})})){const s=E.create(this.environment);await f.Xv({environment:this.environment,spaceStore:e,group:t,transaction:s}),E.commit({environment:this.environment,transaction:s}),O.dan(this.environment)}})),d()(this,"handleNameChange",(e=>{this.props.spacePermissionsSettingsStore.setState({...this.props.spacePermissionsSettingsStore.state,groupNameInputValue:e})})),d()(this,"handleNameCancel",(()=>{const{spacePermissionsSettingsStore:e}=this.props;e.setState({...e.state,editingNameGroupId:void 0,groupNameInputValue:""})})),d()(this,"handleNameAccept",(()=>{const{store:e,group:t,spacePermissionsSettingsStore:s}=this.props,{editingNameGroupId:i,groupNameInputValue:o}=s.state;if(i===t.id){if(o!==t.name){const s={...t,name:o};E.createAndCommit(this.environment,(t=>{f.jF({spaceStore:e,group:s,transaction:t})}))}s.setState({...s.state,editingNameGroupId:void 0,groupNameInputValue:""})}})),d()(this,"handleTokenInputMenuItemRemoveLastToken",(()=>{const{temporaryUserIds:e}=this.stores.spacePermissionGroupStore.state,t=e.slice(0,e.length-1);this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,temporaryUserIds:t})})),d()(this,"handleTokenInputMenuItemChange",(e=>{const t=e.target.value,{spacePermissionGroupStore:s}=this.stores,{extractedEmails:i,newInputValue:o}=(0,Te.zI)(t),{currentSpaceStore:r}=Ie.default.state,{data:n}=j.default.state;if(!n||!r)return;const a=(0,W.uF)(n).map((e=>e.userId)),d=p().compact(a.map((e=>b.Z.createChildStore(r,{table:h.KJ,id:e}).getValue()))).filter((e=>i.includes(e.email)&&!s.state.temporaryUserIds.includes(e.id)));s.setState({...s.state,temporaryUserIds:[...s.state.temporaryUserIds,...d.map((e=>e.id))],userInputValue:o})})),d()(this,"handleAddDoneClick",(()=>{const{store:e,group:t}=this.props,{temporaryUserIds:s}=this.stores.spacePermissionGroupStore.state,i=t.user_ids||[],o=p().union(i,s),r={...t,user_ids:o};E.createAndCommit(this.environment,(t=>{f.jF({spaceStore:e,group:r,transaction:t})})),this.stores.spacePermissionGroupStore.reset(),this.stores.addMemberButtonPopupStore.setState({...this.stores.addMemberButtonPopupStore.state,open:!1}),O.Kf$(this.environment,{add_member_count:s.length})})),d()(this,"handleAddMemberButtonPopupClose",(()=>{this.stores.spacePermissionGroupStore.reset()})),d()(this,"handleShowMoreClick",(()=>{this.stores.spacePermissionGroupStore.setState({...this.stores.spacePermissionGroupStore.state,limitUsers:!1})}))}renderComponent(){const{store:e,group:t,spacePermissionsSettingsStore:s,disabled:i}=this.props,{groupsFilter:r}=s.state,{limitUsers:a}=this.stores.spacePermissionGroupStore.state,d=Fe.k({intl:this.props.intl,group:t}),{countRemainingUsers:l,totalNumberMembers:u,limitedUserValues:c}=Fe.r({group:t,spaceStore:e,limit:a&&!r?Ge.defaultLimit:void 0}),g=p().sortBy(c,(e=>(0,h.of)(e))),v=(r?(0,S.ZP)(r,g,(e=>(0,h.of)(e))):g).sort(((t,s)=>{if(!e.state.value)return 0;const i=e.state.value;return Number((0,Be.wv)(i,s.id))-Number((0,Be.wv)(i,t.id))})),{mouseEntered:f}=this.stores.mouseStore.state,y=f&&!ke.Z.state.isKeyboardMode&&!i,{editingNameGroupId:b,groupNameInputValue:M}=s.state;return n()("div",{style:{marginBottom:36,fontSize:14,width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseDown:this.handleMouseDown},void 0,n()("div",{style:{display:"flex"}},void 0,!i&&n()(he.Z,{isVisible:!0,animationStyle:{opacity:y?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>n()("div",{style:{marginLeft:-24,marginRight:4},className:Ge.dragHandleClass},void 0,n()(fe.Z,{hideClickMessage:!0}))}),n()(oe.Z,i?{disabled:!0,icon:t.icon?{pointer:e.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:d,style:{marginLeft:3,marginRight:3}}:{disabled:!1,bucket:"public",icon:t.icon?{pointer:e.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:d,onChange:this.handleIconChange,style:{marginLeft:3,marginRight:3}}),b===t.id?n()(be.Z,{capture:!0,onEsc:this.handleNameCancel},void 0,n()(Me.Z,{disabled:i,type:Me.Z.Type.Inline,style:{marginLeft:4,cursor:"text",fontWeight:we.Z.fontWeight.semibold},placeholderStyle:{marginLeft:4,cursor:"text",color:this.theme.lightTextColor,fontWeight:we.Z.fontWeight.semibold},placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.userGroup.groupNameInput.placeholder",defaultMessage:"Untitled"}),focus:!0,value:M,onChange:this.handleNameChange,onBlur:this.handleNameAccept,onSubmit:this.handleNameAccept})):n()(_.Z,{isSmall:!0,style:{fontWeight:we.Z.fontWeight.semibold,marginLeft:-2,marginTop:-1},onClick:this.handleRename,disabled:i,className:"notranslate"},void 0,d),u>0&&n()("div",{style:{alignItems:"center",marginLeft:8,color:this.theme.mediumTextColor},className:"notranslate"},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:u}})),n()("div",{style:{flexGrow:1}}),!i&&n()(C.Z,{popupType:de.kQ.Popup,render:this.renderActionMenu,buttonPopupStore:this.stores.actionMenuButtonPopupStore,renderOrigin:e=>m().createElement(Ce.Z,o()({icon:V.Z.dots},e))})),n()(w.Z,{size:12}),v.map(this.renderUser),l>0&&n()("div",{},void 0,n()(_.Z,{isGray:!0,style:{marginTop:4},onClick:this.handleShowMoreClick},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.showMoreUsersButton.label",defaultMessage:"{numberOfHiddenUsers, plural, one {Show {numberOfHiddenUsers} more} other {Show {numberOfHiddenUsers} more}}",values:{numberOfHiddenUsers:l}}))),!i&&n()(C.Z,{popupType:de.kQ.Popup,render:this.renderAddMemberMenu,buttonPopupStore:this.stores.addMemberButtonPopupStore,onClose:this.handleAddMemberButtonPopupClose,style:{width:400},renderOrigin:e=>n()("div",{},void 0,m().createElement(_.Z,o()({isGray:!0,icon:V.Z.plus,style:{marginTop:4}},e),n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupList.addMemberButton.label",defaultMessage:"Add members"})))}))}}d()(Ge,"dragHandleClass","drag_handle"),d()(Ge,"defaultLimit",10);const Re=(0,K.injectIntl)(Ge);var Ee=s(15510),Ue=s(88632),De=s(92083),Oe=s(42402),Ne=s(33058),ze=s(74523),_e=s(46951),Ve=s(47714),We=s(66055),je=s(68932),Ke=s(33665),He=s(23189),qe=s(69435),Ye=s(97880),Je=s(77907),Qe=s(38755),$e=s(21752),Xe=s(14947),et=s(95155);class tt extends M.Z{constructor(...e){super(...e),d()(this,"storeTypes",{spacePermissionsSettingsStore:y.Z}),d()(this,"renderSpaceGroup",(e=>{const{store:t}=this.props,{spacePermissionsSettingsStore:s}=this.stores;return n()(Re,{store:t,group:e,spacePermissionsSettingsStore:s,disabled:!this.canEditGroups()},e.id)})),d()(this,"handleUpdateClick",(()=>{const e=(0,K.defineMessages)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});N.j({message:e.updatingPermissions})})),d()(this,"handleUpdateComplete",(()=>{N.x()})),d()(this,"handleTabClick",(e=>{const t=e;switch(t){case y.Q.Members:O.qTS(this.environment,{tab:"members"});break;case y.Q.Groups:O.qTS(this.environment,{tab:"groups"});break;case y.Q.Guests:O.qTS(this.environment,{tab:"guests"});break;default:(0,Ye.t1)(t)}this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,currentTab:e})})),d()(this,"handleCreateGroupClick",(()=>{E.createAndCommit(this.environment,(e=>{const t=f.mo({spaceStore:this.props.store,transaction:e});t&&this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,editingNameGroupId:t.id,groupNameInputValue:""})})),O.O8v(this.environment)})),d()(this,"handleGroupReorder",(e=>{const t=this.props.store.getValue();if(t){const s=t.permission_groups||[],i=p().compact(e.map((e=>s.find((t=>t.id===e)))));E.createAndCommit(this.environment,(e=>{f.oD({spaceStore:this.props.store,groups:i,transaction:e})}))}O.HCh(this.environment)})),d()(this,"handleFilterChange",(e=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,groupsFilter:e.target.value})})),d()(this,"handleMembersShowMoreClick",(()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitMembers:!1})})),d()(this,"handleGuestsShowMoreClick",(()=>{this.stores.spacePermissionsSettingsStore.setState({...this.stores.spacePermissionsSettingsStore.state,limitGuests:!1})})),d()(this,"handleInviteLinkClick",(()=>{const e=!this.getInviteLinkEnabled();O.eoz(this.environment,{enabled:e}),E.createAndCommit(this.environment,(t=>{f.ys({transaction:t,spaceStore:this.props.store,inviteLinkEnabled:Boolean(e)})}))})),d()(this,"handleUserHeaderClick",(()=>{this.handleSortClick("members","name")})),d()(this,"handleAccessLevelHeaderClick",(()=>{this.handleSortClick("members","role")})),d()(this,"handleSortClick",((e,t)=>{const s=this.stores.spacePermissionsSettingsStore.state.sorts[e];let i;i=!(!s||s.by!==t)&&s.asc,this.stores.spacePermissionsSettingsStore.update((s=>({...s,sorts:{...s.sorts,[e]:{by:t,asc:!i}}})))})),d()(this,"handleMemberPermissionRoleChange",(async(e,t,s)=>{const{store:i}=this.props,o=this.environment.currentUser.id;if(e.userId===o&&"none"===t){await f.bf({environment:this.environment,spaceId:i.id,userSettingsStore:s})&&De.ZP.setState({...De.ZP.state,open:!1})}else this.handleUpdateClick(),"none"===t?(await A.removeUsersFromSpace(this.environment,{userIds:[e.userId],spaceId:i.id,removePagePermissions:!0,revokeUserTokens:!0}),await G.bi(this.environment)):await E.createAndCommit(this.environment,(s=>v.ep({environment:this.environment,store:i,permissionItems:[{type:"user_permission",role:t,user_id:e.userId}],transaction:s}))),this.handleUpdateComplete()}))}renderComponent(){const{store:e,isMobile:t}=this.props;if(!Ue.Z.state.online)return this.renderOfflineMessage();const{data:s}=j.default.state;if(!s)return this.renderLoadingSpinner();const i=W.uF(s);if(!p().every(i.map((t=>b.Z.createChildStore(e,{table:h.KJ,id:t.userId}).isReady()))))return this.renderLoadingSpinner();const o=i.filter(c.CF),r=i.filter(c.du),{currentTab:a}=this.stores.spacePermissionsSettingsStore.state;if(t)return n()(u.Fragment,{},void 0,this.canAdmin()&&n()(F.Z,{shouldShowBottomDivider:!0},void 0,this.renderMobileInviteButton(),n()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteLink())),n()(F.Z,{},void 0,this.renderSpaceMembers(o)));const d=[n()(K.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members ({numberOfMembers})",values:{numberOfMembers:o.length}}),n()(K.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"})];return r.length>0&&d.push(n()(K.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests ({numberOfGuests})",values:{numberOfGuests:r.length}})),n()(X.Z,{},void 0,n()(te.Z,{tabs:d,selectedIndex:a,onChange:this.handleTabClick,style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),this.renderTab(a,o,r))}renderLoadingSpinner(){return n()(je.Z,{style:{margin:"calc(50% - 1em) auto"}})}renderOfflineMessage(){return n()(_e.Z,{isSmall:!0,style:{textAlign:"center"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."}))}renderHelp(){return n()("div",{style:{marginTop:24,marginBottom:24}},void 0,n()(ze.Z,{title:n()(K.FormattedMessage,{id:"spacePermissionsSettings.helpButton.caption",defaultMessage:"Learn about adding members to your workspace"}),href:(0,Ke.UY)("guides.members"),analyticsFrom:"members_settings"}))}renderTab(e,t,s){return e===y.Q.Members?n()(u.Fragment,{},void 0,this.renderSpaceMembers(t)):e===y.Q.Guests?n()(u.Fragment,{},void 0,this.renderSpaceGuests(s)):this.renderGroupsTab()}renderGroupsTab(){const{store:e}=this.props,{groupsFilter:t}=this.stores.spacePermissionsSettingsStore.state,s=e.getValue(),i=this.canUseGroups(),r=this.canEditGroups();if(s){const e=s.permission_groups||[];return n()("div",{},void 0,i?n()(_e.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})):n()(qe.Z,{for:"team",from:"permission_groups",icon:V.Z.group,title:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeCaption",defaultMessage:"Upgrade to the Team Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),n()(w.Z,{size:24,isHidden:!0}),n()("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},void 0,i&&n()(U.Z,{renderTooltip:()=>this.canAdmin()?n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeMessage",defaultMessage:"Upgrade to Team or Enterprise to use permission groups."}):n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.adminsOnly",defaultMessage:"Only admins can add a permission group."}),render:e=>m().createElement(Ze.Z,o()({isLarge:!0,onClick:this.handleCreateGroupClick,disabled:!r},r?void 0:e),n()(K.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"}))}),e.length>0&&n()(Q.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.groupsTab.filterGroupsInput.placeholder",defaultMessage:"Filter by email or name…"}),left:V.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:Q.Z.Format.Small,value:t,style:{...tt.filterStyle,marginRight:0},onChange:this.handleFilterChange})),e.length>0&&n()(w.Z,{size:24,style:{marginBottom:24}}),r?n()(Ee.Z,{direction:Ee.K.Vertical,keys:e.map((e=>e.id)),renderKey:(t,s)=>this.renderSpaceGroup(e[s]),isFullWidth:!0,onDrop:this.handleGroupReorder}):n()("div",{},void 0,e.map(this.renderSpaceGroup)))}}renderSpaceMembers(e){return this.props.isMobile?this.renderMobileMemberList(e):n()("div",{},void 0,!this.shouldRenderUpsell()&&this.renderHelp(),this.shouldRenderUpsell()&&this.renderUpsell(),this.renderInviteLink(),this.renderDesktopMemberList(e))}renderInviteLink(){if(!this.canUseInviteLink())return;const e=this.getInviteLink(),t=this.getInviteLinkEnabled();if(!e)return;const{spacePermissionsSettingsStore:s}=this.stores;return n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"flex-start",cursor:"pointer"}},void 0,n()("div",{style:{marginRight:8,flexGrow:1}},void 0,n()(He.Z,{},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})),n()(_e.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption",defaultMessage:"Share this secret link to invite people to this workspace. Only admins can see this."})," ",!this.props.isMobile&&this.renderInviteLinkReset())),n()("div",{style:{marginTop:5}},void 0,n()(Ve.Z,{on:t,onClick:this.handleInviteLinkClick}))),s&&t&&e&&this.renderInviteLinkUrl(e),n()(w.Z,{size:40}))}renderInviteLinkReset(){const{store:e}=this.props,t=e.getValue();if(t)return n()(K.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink",defaultMessage:"You can <resetlink>reset the link</resetlink> for all space members to generate a new invite link.",values:{resetlink:(...e)=>n()(Oe.Z,{onClick:()=>{L.showDialog({message:n()(K.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:L.dismissDialog,items:[{label:n()(K.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await A.refreshInviteLink(this.environment,{spaceId:t.id}),G.bi(this.environment)}}]})}},void 0,e)}})}renderInviteLinkUrl(e){const{mobileNative:t}=this.environment,s=n()(K.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"}),i=()=>{We.RD({environment:this.environment,stringValue:e,copiedMessage:We.tq.copiedLinkToClipboard}),O.nlj(this.environment)},o=()=>{t&&t.share(e),O.nlj(this.environment)};return this.props.isMobile?n()("div",{},void 0,n()(Q.Z,{type:"text",format:Q.B.Default,value:e,disabled:!0}),t?n()(z.Z,{onClick:o,style:{marginTop:10,width:"100%"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.shareButton",defaultMessage:"Share link"})):n()(z.Z,{onClick:i,style:{marginTop:10,width:"100%"}},void 0,s)):n()("div",{},void 0,n()("div",{style:{display:"flex",alignItems:"flex-start",marginTop:12}},void 0,n()(Q.Z,{type:"text",format:Q.B.Default,value:e,disabled:!0,style:{borderTopRightRadius:0,borderBottomRightRadius:0,width:"calc(100% - 90px)",height:32}}),n()(Ze.Z,{onClick:i,style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,width:90},isLarge:!0},void 0,s)))}renderMobileMemberList(e){const{store:t}=this.props;return n()(u.Fragment,{},void 0,e.map((e=>{const s=b.Z.createChildStore(t,{table:h.KJ,id:e.userId}).getValue();return n()("div",{style:{display:"flex",alignItems:"center",padding:10,borderBottom:"1px solid ".concat(this.theme.lightDividerColor),background:this.theme.cardContentBackground}},void 0,this.renderMember(s),n()("div",{style:{textAlign:"center",marginLeft:"auto"}},void 0,this.renderUserPermission(e)))})))}renderUpsell(){const{data:e}=j.default.state,t=e&&!W.Ln(this.environment,e)&&"subscribed_admin"!==e.type?"team_free":"team";return m().createElement(m().Fragment,null,n()(qe.Z,{for:t,from:"members_settings",icon:V.Z.membersFilled,title:n()(K.FormattedMessage,{id:"spacePermissionSettings.memberUpsell.title",defaultMessage:"Share with unlimited members"}),caption:n()(K.FormattedMessage,{id:"spacePermissionSettings.memberUpsell.caption",defaultMessage:"Try Notion for Teams for a collaborative workspace, unlimited team members, and advanced permissions."}),learnMoreRoute:"guides.members",upgradeMessage:n()(K.FormattedMessage,"team_free"===t?{id:"spacePermissionSettings.memberUpsell.alternativeTrialLabel",defaultMessage:"Try it free"}:{id:"spacePermissionSettings.memberUpsell.alternativeUpgradeLabel",defaultMessage:"Upgrade to Team Plan"})}),n()(w.Z,{size:48}))}renderDesktopMemberList(e){const{spacePermissionsSettingsStore:t}=this.stores,{membersFilter:s,limitMembers:i}=t.state,o=this.getFilteredMembers(e,s),r=this.sortUsers("members",o),a=i?r.slice(0,tt.defaultLimit):r;return n()(m().Fragment,{},void 0,n()("div",{style:{marginRight:8,flexGrow:1}},void 0,n()(He.Z,{},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.members.title",defaultMessage:"Members"}))),this.renderInviteViaDomainCaption(),n()(w.Z,{size:16,isHidden:!0}),n()("div",{},void 0,n()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,this.renderInviteButton(),n()(Q.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterMembersInput.placeholder",defaultMessage:"Filter by email or name…"}),left:V.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:Q.Z.Format.Small,value:s,style:tt.filterStyle,onChange:e=>{t.setState({...t.state,membersFilter:e.target.value,limitMembers:!0})}})),this.renderUserTable("members",a),r.length>tt.defaultLimit&&i&&n()(Ne.Z,{style:tt.showMoreButtonStyle,onClick:this.handleMembersShowMoreClick},void 0,n()(K.FormattedMessage,{defaultMessage:"Show {moreMembersCount} more",id:"spacePermissionsSettings.membersTab.showMore.message",values:{moreMembersCount:r.length-tt.defaultLimit}}))))}renderSpaceGuests(e){const{spacePermissionsSettingsStore:t}=this.stores,{guestsFilter:s,limitGuests:i}=t.state,o=this.getFilteredMembers(e,s),r=this.sortUsers("guests",o),a=i?r.slice(0,tt.defaultLimit):r;return n()("div",{},void 0,n()("div",{},void 0,n()("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}},void 0,n()(Q.Z,{placeholder:this.props.intl.formatMessage({id:"spacePermissionsSettings.membersTab.filterGuestsInput.placeholder",defaultMessage:"Filter by email or name…"}),left:V.Z.searchThick(this.getSearchIconStyle()),showClearButton:!0,format:Q.Z.Format.Small,value:s,style:tt.filterStyle,onChange:e=>{t.setState({...t.state,guestsFilter:e.target.value,limitGuests:!0})}})),this.renderUserTable("guests",a),r.length>tt.defaultLimit&&i&&n()(Ne.Z,{style:tt.showMoreButtonStyle,onClick:this.handleGuestsShowMoreClick},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.membersTab.showMoreGuestsButton.label",defaultMessage:"{numberOfHiddenGuests, plural, one {Show {numberOfHiddenGuests} more} other {Show {numberOfHiddenGuests} more}}",values:{numberOfHiddenGuests:r.length-tt.defaultLimit}}))))}renderMobileInviteButton(){return n()(u.Fragment,{},void 0,n()("div",{style:this.mobileMenuItemStyle()},void 0,this.renderInviteButton({flex:1})),n()("div",{style:{borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}}))}renderInviteButton(e){const{store:t}=this.props;return n()(Je.LazyPermissionsInviteWithModal,{disabled:!this.canAdmin(),store:t,onInviteClick:this.handleUpdateClick,onInviteComplete:this.handleUpdateComplete,isSubscribed:this.isSubscribed(),membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,buttonStyle:e})}renderInviteViaDomainCaption(){const{store:e}=this.props;return f.LV(e)?n()(_e.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,n()(K.FormattedMessage,{id:"spaceBasicSettings.membersTab.manageMembersWithLinkCaption",defaultMessage:"Manage members here."})):n()("div",{},void 0,n()(_e.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",marginBottom:6}},void 0,n()(K.FormattedMessage,{id:"spaceBasicSettings.membersTab.manageMembersWithoutLinkCaption",defaultMessage:"Manage members here, or <setupdomainlink>set up a domain</setupdomainlink>, so everyone with allowed email domains can join the workspace automatically.",values:{setupdomainlink:(...e)=>n()(Oe.Z,{onClick:()=>{De.ZP.setState({...De.ZP.state,currentTab:"settings"})}},void 0,e)}})),n()(_e.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"}},void 0,n()(K.FormattedMessage,{id:"spaceBasicSettings.membersTab.payPerMemberCaption",defaultMessage:"Note: you will be charged for each member added. Visit <billingguidelink>our guide</billingguidelink> for more information on how we bill.",values:{billingguidelink:(...e)=>n()(Oe.Z,{href:(0,Ke.UY)("guides.billingGuide")},void 0,e)}})))}getFilteredMembers(e,t){const{store:s}=this.props;return t&&t.length>0?(0,S.ZP)(t,e,(e=>{const t=b.Z.createChildStore(s,{table:h.KJ,id:e.userId}).getValue();return t?(0,h.of)(t):""})):e}sortUsers(e,t){const s=this.stores.spacePermissionsSettingsStore.state.sorts[e];if(!s)return t;const{store:i}=this.props;switch(s.by){case"role":return t.sort(((e,t)=>(g.xm[t.role]-g.xm[e.role])*(s.asc?-1:1)));case"name":return t.map((e=>({user:e,store:b.Z.createChildStore(i,{table:h.KJ,id:e.userId})}))).sort(((e,t)=>{const i=e.store.getValue(),o=t.store.getValue(),r=(0,h.Nz)(this.props.intl,i),n=(0,h.Nz)(this.props.intl,o);return r.localeCompare(n)*(s.asc?1:-1)})).map((e=>e.user))}}renderSmallArrow(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?V.Z.arrowDownSmall({...s,transform:"rotate(180deg)"}):V.Z.arrowDownSmall(s)}renderUserTable(e,t){const{store:s}=this.props,i=this.stores.spacePermissionsSettingsStore.state.sorts[e],o="on"===et.default.getGroup("workspace-user-sort-and-filter");return n()(ee.Z,{columns:[{key:"user",header:n()(Xe.Z,{disabled:!o,ignoreLocalHoverState:!0,onClick:()=>{this.handleSortClick(e,"name")},style:{display:"flex",alignItems:"center"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),i&&"name"===i.by?this.renderSmallArrow({up:i.asc}):null),style:{width:"75%"}},{key:"access_level",header:n()(Xe.Z,{disabled:!o,ignoreLocalHoverState:!0,onClick:()=>{this.handleSortClick(e,"role")},style:{display:"flex",alignItems:"center",justifyContent:"center"}},void 0,n()(K.FormattedMessage,{id:"spacePermissionsSettings.userTable.accessLevelColumn.header",defaultMessage:"Access level"}),i&&"role"===i.by?this.renderSmallArrow({up:i.asc}):null),style:{width:"25%",textAlign:"center"}}],rows:t.map((e=>({member:e,store:b.Z.createChildStore(s,{table:h.KJ,id:e.userId})}))).filter((e=>void 0!==e.store.getValue())).map((e=>{const{member:t,store:s}=e,i=s.getValue();return{key:t.userId,columns:[this.renderMember(i),n()("div",{style:{textAlign:"center"}},void 0,this.renderUserPermission(t))]}}))})}renderMember(e){return n()($e.Z,{userValue:e})}renderUserPermission(e){return"none"===e.role?n()(J,{store:this.props.store,guest:e,isSubscribed:this.isSubscribed()}):this.renderMemberRoleSelect(e)}renderMemberRoleSelect(e){const t=this.environment.currentUser.id,{currentUserSettingsStore:s}=Ie.default.state;if(s)return n()($.Z,{role:e.role,table:se.bx,type:"user_permission",disabled:!this.canAdmin(),isUserPermission:e.userId===t,isSubscribed:this.isSubscribed(),upgradeButtonName:"space_permission_item",onChange:t=>this.handleMemberPermissionRoleChange(e,t,s)})}isSubscribed(){const{data:e}=j.default.state;return Boolean(e&&W.YK(e))}canAdmin(){return this.props.store.canAdmin()}canUseGroups(){return W.qF(this.environment)&&this.isSubscribed()}canEditGroups(){return this.canUseGroups()&&this.canAdmin()}canUseInviteLink(){return this.canAdmin()&&W.qF(this.environment)}shouldRenderUpsell(){const e=this.props.store.getValue();return Boolean(e&&"personal"===e.plan_type&&this.canAdmin())}getInviteLinkEnabled(){const e=this.props.store.getValue();return Boolean(e&&e.invite_link_enabled)}getInviteLink(){const e=j.default.state.data,t=this.props.store.id,s=!e||"subscribed_admin"!==e.type&&"unsubscribed_admin"!==e.type?void 0:e.inviteLinkCode;if(s)return(0,Qe.createSpaceInviteLinkUrl)(this.environment,t,s)}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}mobileMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",paddingTop:14,paddingBottom:14,paddingLeft:14,paddingRight:e.getSafePaddingRightCSS(14),background:this.theme.cardContentBackground}}}d()(tt,"defaultLimit",50),d()(tt,"filterStyle",{maxWidth:250,borderRadius:30}),d()(tt,"showMoreButtonStyle",{marginTop:8});const st=(0,K.injectIntl)(tt)},42982:(e,t,s)=>{s.d(t,{Z:()=>m});var i=s(98135),o=s.n(i),r=(s(67294),s(5366)),n=s(66832),a=s(47966),d=s(23189),l=s(46951),p=s(86512);class u extends n.Z{renderComponent(){return o()("div",{},void 0,this.renderHeader(),o()("div",{style:this.getSettingsOptionStyle()},void 0,o()(l.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"}},void 0,this.renderMessage()),this.renderManageSubscriptionButton()))}renderHeader(){const{device:e}=this.environment;return o()(d.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full"},void 0,o()(r.FormattedMessage,{id:"subscriptionSettings.title",defaultMessage:"Subscription"}))}renderMessage(){const{device:e}=this.environment;return e.isMobile?o()(r.FormattedMessage,{id:"subscriptionSettings.mobileDescription",defaultMessage:"Manage your Personal Pro subscription though the App Store.",description:"Description for a button that will take users to Apple's App Store app to edit their subscription."}):o()(r.FormattedMessage,{id:"subscriptionSettings.description",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. You can manage your subscription in Apple's subscription settings.",description:"Description for a button that will take users to Apple's App Store app to edit their subscription."})}renderManageSubscriptionButton(){return o()(p.Z,{href:"https://apps.apple.com/account/subscriptions"},void 0,o()(a.Z,{isLarge:!0,style:{marginTop:12,marginBottom:4}},void 0,o()(r.FormattedMessage,{id:"subscriptionSettings.button",defaultMessage:"Manage subscription"})))}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const m=u},40235:(e,t,s)=>{s.d(t,{Z:()=>u});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(67294),s(66832)),d=s(46951),l=s(82990);class p extends a.Z{renderComponent(){const{columns:e,rows:t,cellStyle:s,tableStyle:i}=this.props;return o()("table",{style:{...this.getStyle(),...i}},void 0,o()("thead",{},void 0,o()("tr",{style:p.headerRowStyle},void 0,e.map((e=>o()("th",{style:{...p.tableHeaderStyle,...e.style}},e.key,o()(d.Z,{isSmall:!0},void 0,e.header)))))),o()("tbody",{},void 0,t.map((t=>o()("tr",{style:this.getRowStyle()},t.key,t.columns.map(((t,i)=>{const r=e[i];return o()("td",{style:{...p.cellStyle,...s}},r.key,t)})))))))}getStyle(){return{width:"100%",fontSize:13,borderTop:"1px solid ".concat(this.theme.regularDividerColor),borderBottom:"1px solid ".concat(this.theme.regularDividerColor)}}getRowStyle(){return{width:"100%",borderTop:"1px solid ".concat(this.theme.regularDividerColor)}}}n()(p,"cellPaddingTopBottom",8),n()(p,"headerRowStyle",{height:32,width:"100%"}),n()(p,"tableHeaderStyle",{fontWeight:l.Z.fontWeight.regular,textAlign:"left",paddingTop:p.cellPaddingTopBottom,paddingBottom:p.cellPaddingTopBottom}),n()(p,"cellStyle",{paddingTop:p.cellPaddingTopBottom,paddingBottom:p.cellPaddingTopBottom});const u=p},69435:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(33948),s(67294),s(66832)),d=s(72693),l=s(47966),p=s(33665),u=s(50906),m=s(93678),c=s(26111),g=s(82990),h=s(5366);class v extends a.Z{constructor(...e){super(...e),n()(this,"handleUpgradeClick",(e=>{const{from:t,for:s,onUpgradeClick:i}=this.props;m.y(this.environment,{from:t,for:s}),i&&i(e)})),n()(this,"handleLearnMoreClick",(()=>{const{from:e,learnMoreRoute:t}=this.props;(0,c.navigateToExternalURL)({environment:this.environment,url:(0,p.UY)(t)}),u.Fsx(this.environment,{from:e})}))}renderComponent(){return o()("section",{style:this.getWrapStyle()},void 0,this.renderIcon(),this.renderTitle(),this.renderCaption(),this.renderActions())}renderIcon(){const{icon:e}=this.props;return e(this.getIconStyle())}renderTitle(){const{title:e}=this.props;return o()("header",{style:this.getTitleStyle()},void 0,e)}renderCaption(){const{caption:e}=this.props;return o()("p",{style:this.getCaptionStyle()},void 0,e)}renderActions(){return o()("footer",{},void 0,this.renderUpgradeButton(),this.renderLearnMoreButton())}renderUpgradeButton(){const{upgradeMessage:e}=this.props;return o()(d.Z,{onClick:this.handleUpgradeClick,isLarge:!0},void 0,e||o()(h.FormattedMessage,{defaultMessage:"Upgrade",id:"upsellCallout.upgradeButton.text"}))}renderLearnMoreButton(){return o()(l.Z,{onClick:this.handleLearnMoreClick,style:this.getLearnMoreButtonStyle()},void 0,o()(h.FormattedMessage,{defaultMessage:"Learn more",id:"upsellCallout.learnMoreButton.text"}))}getWrapStyle(){const{device:e}=this.environment;return{fontSize:14,...!e.isMobile&&{maxWidth:340}}}getIconStyle(){return{width:32,height:"auto",fill:this.theme.mediumIconColor,marginBottom:8}}getTitleStyle(){return{fontWeight:g.Z.fontWeight.semibold}}getCaptionStyle(){return{color:this.theme.mediumTextColor,marginTop:4,marginBottom:16}}getLearnMoreButtonStyle(){return{marginLeft:12}}}const f=v},30045:(e,t,s)=>{s.d(t,{Z:()=>b});var i=s(98135),o=s.n(i),r=s(59713),n=s.n(r),a=(s(33948),s(67294),s(5366)),d=s(66832),l=s(46951),p=s(72087),u=s(63143),m=s(7765),c=s(4122),g=s(27832),h=s(58762),v=s(17256),f=s(47966),S=s(23189);class y extends d.Z{constructor(...e){super(...e),n()(this,"storeTypes",{requestStore:p.Z}),n()(this,"renderResult",((e,t,s)=>o()(c.Z,{loaded:s,spinnerSize:16,showSpinnerTimeout:600},void 0,e||!t?o()("div",{},void 0,this.props.intl.formatMessage({id:"userDataConsent.render.error",defaultMessage:"Something went wrong"})):this.renderOutput(t)))),n()(this,"renderOutput",(e=>{const t=Boolean(e.expiryTime&&Number(e.expiryTime)>Date.now()),s=t?this.revokeDataAccess:this.grantDataAccess;return o()("div",{style:this.getSettingsOptionStyle()},void 0,o()("div",{style:{display:"flex",alignItems:"flex-start",marginBottom:12,width:"100%"}},void 0,o()("div",{style:{flex:1}},void 0,o()(S.Z,{},void 0,o()(a.FormattedMessage,{id:"userDataConsentSettings.header.label",defaultMessage:"Support access"})),o()(l.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4,width:"80%"}},void 0,t&&e.expiryTime?o()(a.FormattedMessage,{id:"userDataConsentSettings.accessGranted.label",defaultMessage:"You have granted Notion access to your account for support purposes until {expiryTime}.",values:{expiryTime:v.Z.unix(e.expiryTime/1e3).locale(this.props.intl.locale).format("lll")}}):o()(a.FormattedMessage,{id:"userDataConsentSettings.accessNotGranted.label",defaultMessage:"Grant Notion support temporary access to your account so we can troubleshoot problems or recover content on your behalf. You can revoke access at any time."})),o()(f.Z,{onClick:s,isLarge:!0,style:{marginTop:12,marginBottom:4}},void 0,o()(a.FormattedMessage,t?{id:"userDataConsentSettings.revokeSupportAccess.button",defaultMessage:"Revoke access"}:{id:"userDataConsentSettings.allowSupportAccess.button",defaultMessage:"Allow support access"})))))})),n()(this,"fetchUserDataConsentSettings",(async e=>{const t=await h.getDataAccessConsent(this.environment,{});if("failed"===t.type)throw t.error;return t.data})),n()(this,"grantDataAccess",(async()=>{await this.setDataAccessExpiryTime({expiryTime:Date.now()+14*u.A0})})),n()(this,"revokeDataAccess",(async()=>{await this.setDataAccessExpiryTime({})})),n()(this,"setDataAccessExpiryTime",(async e=>{const t=await h.setDataAccessConsent(this.environment,e);if("success"===t.type&&t.data){const e=this.stores.requestStore.state;this.stores.requestStore.setState({...e,result:t.data})}}))}renderComponent(){const{currentUserStore:e}=g.default.state;return e&&o()(m.Z,{requestStore:this.stores.requestStore,request:{userId:e.id,expiryTime:Date.now()+14*u.A0},performRequest:this.fetchUserDataConsentSettings,render:this.renderResult})}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}const b=(0,a.injectIntl)(y)},81700:(e,t,s)=>{s.d(t,{Z:()=>r});var i=s(52016);class o extends i.Z{getInitialState(){return{open:!1}}}const r=new o}}]);